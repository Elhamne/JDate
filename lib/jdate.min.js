!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("JDate",[],t):"object"==typeof exports?exports.JDate=t():e.JDate=t()}(this,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e,t){e.exports={MONTH_NAMES:["فروردین","اردیبهشت","خرداد","تیر","امرداد","شهریور","مهر","آبان","آذر","دی","بهمن","اسفند"],ABBR_DAYS:["۱ش","۲ش","۳ش","۴ش","۵ش","ج","ش"],DAYS_NAMES:["یکشنبه","دوشنبه","سه‌شنبه","چهارشنبه","پنج‌شنبه","جمعه","شنبه"],GREGORIAN_EPOCH:1721425.5,PERSIAN_EPOCH:1948320.5}},function(e,t,r){"use strict";r.r(t);var n=r(0);function a(e,t){return e-Math.floor(e/t)*t}function o(e){return e&&1===e.length?"0".concat(e):e}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,o;return t=e,o=[{key:"leapGregorian",value:function(e){return e%4==0&&!(e%100==0&&e%400!=0)}},{key:"gregorianToJulian",value:function(t,r,a){var o;return o=r<=2?0:e.leapGregorian(t)?-1:-2,n.GREGORIAN_EPOCH-1+365*(t-1)+Math.floor((t-1)/4)+-Math.floor((t-1)/100)+Math.floor((t-1)/400)+Math.floor((367*r-362)/12+(o+a))}},{key:"julianToGregorian",value:function(t){var r=Math.floor(t-.5)+.5,o=r-n.GREGORIAN_EPOCH,i=Math.floor(o/146097),u=a(o,146097),l=Math.floor(u/36524),f=a(u,36524),c=Math.floor(f/1461),s=a(f,1461),h=Math.floor(s/365),v=400*i+100*l+4*c+h;4!==l&&4!==h&&(v+=1);var p,g=r-e.gregorianToJulian(v,1,1);p=r<e.gregorianToJulian(v,3,1)?0:(e.leapGregorian(v),1);var y=Math.floor((12*(g+p)+373)/367);return[v,y,r-e.gregorianToJulian(v,y,1)+1]}},{key:"leapPersian",value:function(e){return 682*((e-(e>0?474:473))%2820+474+38)%2816<682}},{key:"persianToJulian",value:function(e,t,r){var o=e-(e>=0?474:473),i=474+a(o,2820);return r+(t<=7?31*(t-1):30*(t-1)+6)+Math.floor((682*i-110)/2816)+365*(i-1)+1029983*Math.floor(o/2820)+(n.PERSIAN_EPOCH-1)}},{key:"julianToPersian",value:function(t){var r,n=Math.floor(t)+.5,o=n-e.persianToJulian(475,1,1),i=Math.floor(o/1029983),u=a(o,1029983);if(1029982===u)r=2820;else{var l=Math.floor(u/366),f=a(u,366);r=Math.floor((2134*l+2816*f+2815)/1028522)+l+1}var c=r+2820*i+474;c<=0&&(c-=1);var s=n-e.persianToJulian(c,1,1)+1,h=s<=186?Math.ceil(s/31):Math.ceil((s-6)/30);return[c,h,n-e.persianToJulian(c,h,1)+1]}},{key:"persianToGregorian",value:function(t,r,n){var a=e.persianToJulian(t,r,n);return e.julianToGregorian(a)}},{key:"gregorianToPersian",value:function(t,r,n){var a=e.gregorianToJulian(t,r,n);return e.julianToPersian(a)}}],(r=null)&&i(t.prototype,r),o&&i(t,o),e}();function l(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,a=!1,o=void 0;try{for(var i,u=e[Symbol.iterator]();!(n=(i=u.next()).done)&&(r.push(i.value),!t||r.length!==t);n=!0);}catch(e){a=!0,o=e}finally{try{n||null==u.return||u.return()}finally{if(a)throw o}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function f(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.d(t,"default",function(){return c});var c=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.input=t,Array.isArray(t)?(this.date=t.map(function(e){return parseInt(e,10)}),this._d=this.toGregorian()):t instanceof Date&&(this._d=t,this.date=e.toJalali(this.input))}var t,r,a;return t=e,a=[{key:"toJalali",value:function(e){var t=u.gregorianToJulian(e.getFullYear(),e.getMonth()+1,e.getDate());return u.julianToPersian(t)}},{key:"to_jalali",value:function(t){return e.toJalali(t)}},{key:"toGregorian",value:function(e,t,r){var n=u.julianToGregorian(u.persianToJulian(e,t,r));return new Date(n[0],n[1]-1,n[2])}},{key:"to_gregorian",value:function(t,r,n){return e.toGregorian(t,r,n)}},{key:"isLeapYear",value:function(e){return u.leapPersian(e)}},{key:"daysInMonth",value:function(t,r){var n=t-Math.floor(r/12),a=r-12*Math.floor(r/12);return a<0?(a+=12,n-=1):0===a&&(a=12),a<6?31:a<11?30:e.isLeapYear(n)?30:29}}],(r=[{key:"toGregorian",value:function(){return e.toGregorian(this.date[0],this.date[1],this.date[2])}},{key:"getFullYear",value:function(){return this.date[0]}},{key:"setFullYear",value:function(e){return this.date[0]=parseInt(e,10),this.input=this.toGregorian(),this}},{key:"getMonth",value:function(){return this.date[1]}},{key:"setMonth",value:function(e){var t=l(function(e,t){if(t>12||t<=0){var r=Math.floor((t-1)/12);return[e-r,t-12*r]}return[e,t]}(this.getFullYear(),parseInt(e,10)),2);return this.date[0]=t[0],this.date[1]=t[1],this.input=this.toGregorian(),this}},{key:"getDate",value:function(){return this.date[2]}},{key:"setDate",value:function(e){return this.date[2]=parseInt(e,10),this.input=this.toGregorian(),this}},{key:"getDay",value:function(){return this._d.getDay()}},{key:"format",value:function(e){var t=function e(t,r){var n=t.match(/[yY]+/);if(!n)return t;switch(n[0]){case"YYYY":case"YYY":return e(t.replace(n,r.getFullYear()),r);case"YY":return e(t.replace(n,String(r.getFullYear()).slice(2)),r);default:return t}}(e,this);return t=function e(t,r){var a=t.match(/[dD]+/);if(!a)return t;switch(a[0]){case"D":return e(t.replace(a,r.getDate()),r);case"DD":var i=o(r.getDate().toString());return e(t.replace(a,i),r);case"d":case"dd":return e(t.replace(a,n.ABBR_DAYS[r.getDay()]),r);case"ddd":case"dddd":return e(t.replace(a,n.DAYS_NAMES[r.getDay()]),r);default:return t}}(t=function e(t,r){var a=t.match(/[mM]+/);if(!a)return t;switch(a[0]){case"M":return e(t.replace(a,r.getMonth()),r);case"MM":var i=o(r.getMonth().toString());return e(t.replace(a,i),r);case"MMM":case"MMMM":return e(t.replace(a,n.MONTH_NAMES[r.getMonth()-1]),r);default:return t}}(t,this),this)}}])&&f(t.prototype,r),a&&f(t,a),e}()}]).default});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KRGF0ZS93ZWJwYWNrL3VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24iLCJ3ZWJwYWNrOi8vSkRhdGUvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vSkRhdGUvLi9zcmMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL0pEYXRlLy4vc3JjL2hlbHBlcnMuanMiLCJ3ZWJwYWNrOi8vSkRhdGUvLi9zcmMvY29udmVydGVyLmpzIiwid2VicGFjazovL0pEYXRlLy4vc3JjL2pkYXRlLmpzIl0sIm5hbWVzIjpbInJvb3QiLCJmYWN0b3J5IiwiZXhwb3J0cyIsIm1vZHVsZSIsImRlZmluZSIsImFtZCIsInRoaXMiLCJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiTU9OVEhfTkFNRVMiLCJBQkJSX0RBWVMiLCJEQVlTX05BTUVTIiwiR1JFR09SSUFOX0VQT0NIIiwiUEVSU0lBTl9FUE9DSCIsIm1vZCIsImEiLCJiIiwiTWF0aCIsImZsb29yIiwiemVyb0xlYWRpbmciLCJzdHIiLCJsZW5ndGgiLCJDb252ZXJ0ZXIiLCJ5ZWFyIiwibW9udGgiLCJkYXkiLCJwYWQiLCJsZWFwR3JlZ29yaWFuIiwiamQiLCJ3amQiLCJkZXBvY2giLCJxdWFkcmljZW50IiwiZHFjIiwiY2VudCIsImRjZW50IiwicXVhZCIsImRxdWFkIiwieWluZGV4IiwibGVhcGFkaiIsInllYXJkYXkiLCJncmVnb3JpYW5Ub0p1bGlhbiIsImVwYmFzZSIsImVweWVhciIsInljeWNsZSIsIm5qZCIsInBlcnNpYW5Ub0p1bGlhbiIsImN5Y2xlIiwiY3llYXIiLCJhdXgxIiwiYXV4MiIsInlkYXkiLCJjZWlsIiwianVsaWFuIiwianVsaWFuVG9HcmVnb3JpYW4iLCJqdWxpYW5Ub1BlcnNpYW4iLCJKRGF0ZSIsImlucHV0IiwiRGF0ZSIsIkFycmF5IiwiaXNBcnJheSIsImRhdGUiLCJtYXAiLCJudW0iLCJwYXJzZUludCIsIl9kIiwidG9HcmVnb3JpYW4iLCJ0b0phbGFsaSIsImp1bGlhbkRhdGUiLCJnZXRGdWxsWWVhciIsImdldE1vbnRoIiwiZ2V0RGF0ZSIsImdkYXRlIiwibGVhcFBlcnNpYW4iLCJjYWxjZWRZZWFyIiwiY2FsY2VkTW9udGgiLCJpc0xlYXBZZWFyIiwieWVhckRpZmYiLCJoZWxwZXJzIiwiZ2V0RGF5IiwiZm9ybWF0IiwicmVzdWx0IiwicmVwbGFjZVllYXIiLCJtYXRjaCIsInJlcGxhY2UiLCJTdHJpbmciLCJzbGljZSIsInJlcGxhY2VEYXkiLCJ6ZXJvTGVhZGluZ0RhdGUiLCJ0b1N0cmluZyIsInJlcGxhY2VNb250aCIsInplcm9MZWFkaW5nTW9udGgiXSwibWFwcGluZ3MiOiJDQUFBLFNBQTJDQSxFQUFNQyxHQUMxQixpQkFBWkMsU0FBMEMsaUJBQVhDLE9BQ3hDQSxPQUFPRCxRQUFVRCxJQUNRLG1CQUFYRyxRQUF5QkEsT0FBT0MsSUFDOUNELE9BQU8sUUFBUyxHQUFJSCxHQUNNLGlCQUFaQyxRQUNkQSxRQUFlLE1BQUlELElBRW5CRCxFQUFZLE1BQUlDLElBUmxCLENBU0dLLEtBQU0sV0FDVCxPLFlDVEUsSUFBSUMsRUFBbUIsR0FHdkIsU0FBU0MsRUFBb0JDLEdBRzVCLEdBQUdGLEVBQWlCRSxHQUNuQixPQUFPRixFQUFpQkUsR0FBVVAsUUFHbkMsSUFBSUMsRUFBU0ksRUFBaUJFLEdBQVksQ0FDekNDLEVBQUdELEVBQ0hFLEdBQUcsRUFDSFQsUUFBUyxJQVVWLE9B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UThELEVBQU0sSUFDWixJQUFLLElBRUgsT0FEY0ksRUFBV2xFLEVBQUkrRCxRQUFRRCxFQUFPdEIsRUFBS1UsV0FBWVYsR0FHL0QsSUFBSyxLQUNILElBQU0yQixFQUFrQnBFLEVBQVl5QyxFQUFLVSxVQUFVa0IsWUFFbkQsT0FEY0YsRUFBV2xFLEVBQUkrRCxRQUFRRCxFQUFPSyxHQUFrQjNCLEdBR2hFLElBQUssSUFDTCxJQUFLLEtBRUgsT0FEYzBCLEVBQVdsRSxFQUFJK0QsUUFBUUQsRUFBT3hFLFlBQVVrRCxFQUFLa0IsV0FBWWxCLEdBR3pFLElBQUssTUFDTCxJQUFLLE9BRUgsT0FEYzBCLEVBQVdsRSxFQUFJK0QsUUFBUUQsRUFBT3ZFLGFBQVdpRCxFQUFLa0IsV0FBWWxCLEdBRzFFLFFBQ0UsT0FBT3hDLEdFcUZBeUQsQ0FEVEcsRUZ0SUcsU0FBU1MsRUFBYXJFLEVBQUt3QyxHQUNoQyxJQUFNc0IsRUFBUTlELEVBQUk4RCxNQUFNLFNBQ3hCLElBQUtBLEVBQVMsT0FBTzlELEVBQ3JCLE9BQVE4RCxFQUFNLElBQ1osSUFBSyxJQUVILE9BRGNPLEVBQWFyRSxFQUFJK0QsUUFBUUQsRUFBT3RCLEVBQUtTLFlBQWFULEdBR2xFLElBQUssS0FDSCxJQUFNOEIsRUFBbUJ2RSxFQUFZeUMsRUFBS1MsV0FBV21CLFlBRXJELE9BRGNDLEVBQWFyRSxFQUFJK0QsUUFBUUQsRUFBT1EsR0FBbUI5QixHQUduRSxJQUFLLE1BQ0wsSUFBSyxPQUlILE9BSGM2QixFQUNackUsRUFBSStELFFBQVFELEVBQU96RSxjQUFZbUQsRUFBS1MsV0FBYSxJQUFLVCxHQUkxRCxRQUNFLE9BQU94QyxHRWlIQXlELENBQXFCRyxFQUFRM0csTUFDRkEsVyIsImZpbGUiOiJqZGF0ZS5taW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gd2VicGFja1VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24ocm9vdCwgZmFjdG9yeSkge1xuXHRpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcgJiYgdHlwZW9mIG1vZHVsZSA9PT0gJ29iamVjdCcpXG5cdFx0bW9kdWxlLmV4cG9ydHMgPSBmYWN0b3J5KCk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShcIkpEYXRlXCIsIFtdLCBmYWN0b3J5KTtcblx0ZWxzZSBpZih0eXBlb2YgZXhwb3J0cyA9PT0gJ29iamVjdCcpXG5cdFx0ZXhwb3J0c1tcIkpEYXRlXCJdID0gZmFjdG9yeSgpO1xuXHRlbHNlXG5cdFx0cm9vdFtcIkpEYXRlXCJdID0gZmFjdG9yeSgpO1xufSkodGhpcywgZnVuY3Rpb24oKSB7XG5yZXR1cm4gIiwiIFx0Ly8gVGhlIG1vZHVsZSBjYWNoZVxuIFx0dmFyIGluc3RhbGxlZE1vZHVsZXMgPSB7fTtcblxuIFx0Ly8gVGhlIHJlcXVpcmUgZnVuY3Rpb25cbiBcdGZ1bmN0aW9uIF9fd2VicGFja19yZXF1aXJlX18obW9kdWxlSWQpIHtcblxuIFx0XHQvLyBDaGVjayBpZiBtb2R1bGUgaXMgaW4gY2FjaGVcbiBcdFx0aWYoaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0pIHtcbiBcdFx0XHRyZXR1cm4gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0uZXhwb3J0cztcbiBcdFx0fVxuIFx0XHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuIFx0XHR2YXIgbW9kdWxlID0gaW5zdGFsbGVkTW9kdWxlc1ttb2R1bGVJZF0gPSB7XG4gXHRcdFx0aTogbW9kdWxlSWQsXG4gXHRcdFx0bDogZmFsc2UsXG4gXHRcdFx0ZXhwb3J0czoge31cbiBcdFx0fTtcblxuIFx0XHQvLyBFeGVjdXRlIHRoZSBtb2R1bGUgZnVuY3Rpb25cbiBcdFx0bW9kdWxlc1ttb2R1bGVJZF0uY2FsbChtb2R1bGUuZXhwb3J0cywgbW9kdWxlLCBtb2R1bGUuZXhwb3J0cywgX193ZWJwYWNrX3JlcXVpcmVfXyk7XG5cbiBcdFx0Ly8gRmxhZyB0aGUgbW9kdWxlIGFzIGxvYWRlZFxuIFx0XHRtb2R1bGUubCA9IHRydWU7XG5cbiBcdFx0Ly8gUmV0dXJuIHRoZSBleHBvcnRzIG9mIHRoZSBtb2R1bGVcbiBcdFx0cmV0dXJuIG1vZHVsZS5leHBvcnRzO1xuIFx0fVxuXG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlcyBvYmplY3QgKF9fd2VicGFja19tb2R1bGVzX18pXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm0gPSBtb2R1bGVzO1xuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZSBjYWNoZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5jID0gaW5zdGFsbGVkTW9kdWxlcztcblxuIFx0Ly8gZGVmaW5lIGdldHRlciBmdW5jdGlvbiBmb3IgaGFybW9ueSBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmQgPSBmdW5jdGlvbihleHBvcnRzLCBuYW1lLCBnZXR0ZXIpIHtcbiBcdFx0aWYoIV9fd2VicGFja19yZXF1aXJlX18ubyhleHBvcnRzLCBuYW1lKSkge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBuYW1lLCB7IGVudW1lcmFibGU6IHRydWUsIGdldDogZ2V0dGVyIH0pO1xuIFx0XHR9XG4gXHR9O1xuXG4gXHQvLyBkZWZpbmUgX19lc01vZHVsZSBvbiBleHBvcnRzXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIgPSBmdW5jdGlvbihleHBvcnRzKSB7XG4gXHRcdGlmKHR5cGVvZiBTeW1ib2wgIT09ICd1bmRlZmluZWQnICYmIFN5bWJvbC50b1N0cmluZ1RhZykge1xuIFx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBTeW1ib2wudG9TdHJpbmdUYWcsIHsgdmFsdWU6ICdNb2R1bGUnIH0pO1xuIFx0XHR9XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCAnX19lc01vZHVsZScsIHsgdmFsdWU6IHRydWUgfSk7XG4gXHR9O1xuXG4gXHQvLyBjcmVhdGUgYSBmYWtlIG5hbWVzcGFjZSBvYmplY3RcbiBcdC8vIG1vZGUgJiAxOiB2YWx1ZSBpcyBhIG1vZHVsZSBpZCwgcmVxdWlyZSBpdFxuIFx0Ly8gbW9kZSAmIDI6IG1lcmdlIGFsbCBwcm9wZXJ0aWVzIG9mIHZhbHVlIGludG8gdGhlIG5zXG4gXHQvLyBtb2RlICYgNDogcmV0dXJuIHZhbHVlIHdoZW4gYWxyZWFkeSBucyBvYmplY3RcbiBcdC8vIG1vZGUgJiA4fDE6IGJlaGF2ZSBsaWtlIHJlcXVpcmVcbiBcdF9fd2VicGFja19yZXF1aXJlX18udCA9IGZ1bmN0aW9uKHZhbHVlLCBtb2RlKSB7XG4gXHRcdGlmKG1vZGUgJiAxKSB2YWx1ZSA9IF9fd2VicGFja19yZXF1aXJlX18odmFsdWUpO1xuIFx0XHRpZihtb2RlICYgOCkgcmV0dXJuIHZhbHVlO1xuIFx0XHRpZigobW9kZSAmIDQpICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgdmFsdWUgJiYgdmFsdWUuX19lc01vZHVsZSkgcmV0dXJuIHZhbHVlO1xuIFx0XHR2YXIgbnMgPSBPYmplY3QuY3JlYXRlKG51bGwpO1xuIFx0XHRfX3dlYnBhY2tfcmVxdWlyZV9fLnIobnMpO1xuIFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobnMsICdkZWZhdWx0JywgeyBlbnVtZXJhYmxlOiB0cnVlLCB2YWx1ZTogdmFsdWUgfSk7XG4gXHRcdGlmKG1vZGUgJiAyICYmIHR5cGVvZiB2YWx1ZSAhPSAnc3RyaW5nJykgZm9yKHZhciBrZXkgaW4gdmFsdWUpIF9fd2VicGFja19yZXF1aXJlX18uZChucywga2V5LCBmdW5jdGlvbihrZXkpIHsgcmV0dXJuIHZhbHVlW2tleV07IH0uYmluZChudWxsLCBrZXkpKTtcbiBcdFx0cmV0dXJuIG5zO1xuIFx0fTtcblxuIFx0Ly8gZ2V0RGVmYXVsdEV4cG9ydCBmdW5jdGlvbiBmb3IgY29tcGF0aWJpbGl0eSB3aXRoIG5vbi1oYXJtb255IG1vZHVsZXNcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubiA9IGZ1bmN0aW9uKG1vZHVsZSkge1xuIFx0XHR2YXIgZ2V0dGVyID0gbW9kdWxlICYmIG1vZHVsZS5fX2VzTW9kdWxlID9cbiBcdFx0XHRmdW5jdGlvbiBnZXREZWZhdWx0KCkgeyByZXR1cm4gbW9kdWxlWydkZWZhdWx0J107IH0gOlxuIFx0XHRcdGZ1bmN0aW9uIGdldE1vZHVsZUV4cG9ydHMoKSB7IHJldHVybiBtb2R1bGU7IH07XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18uZChnZXR0ZXIsICdhJywgZ2V0dGVyKTtcbiBcdFx0cmV0dXJuIGdldHRlcjtcbiBcdH07XG5cbiBcdC8vIE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbFxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5vID0gZnVuY3Rpb24ob2JqZWN0LCBwcm9wZXJ0eSkgeyByZXR1cm4gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsKG9iamVjdCwgcHJvcGVydHkpOyB9O1xuXG4gXHQvLyBfX3dlYnBhY2tfcHVibGljX3BhdGhfX1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5wID0gXCJcIjtcblxuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKF9fd2VicGFja19yZXF1aXJlX18ucyA9IDEpO1xuIiwibW9kdWxlLmV4cG9ydHMgPSB7XG4gIE1PTlRIX05BTUVTOiBbJ9mB2LHZiNix2K/bjNmGJywgJ9in2LHYr9uM2KjZh9i02KonLCAn2K7Ysdiv2KfYrycsICfYqtuM2LEnLCAn2KfZhdix2K/Yp9ivJywgJ9i02YfYsduM2YjYsScsICfZhdmH2LEnLCAn2KLYqNin2YYnLCAn2KLYsNixJywgJ9iv24wnLCAn2KjZh9mF2YYnLCAn2KfYs9mB2YbYryddLFxuICBBQkJSX0RBWVM6IFsn27HYtCcsICfbsti0JywgJ9uz2LQnLCAn27TYtCcsICfbtdi0JywgJ9isJywgJ9i0J10sXG4gIERBWVNfTkFNRVM6IFsn24zaqdi02YbYqNmHJywgJ9iv2YjYtNmG2KjZhycsICfYs9mH4oCM2LTZhtio2YcnLCAn2obZh9in2LHYtNmG2KjZhycsICfZvtmG2KzigIzYtNmG2KjZhycsICfYrNmF2LnZhycsICfYtNmG2KjZhyddLFxuICBHUkVHT1JJQU5fRVBPQ0g6IDE3MjE0MjUuNSxcbiAgUEVSU0lBTl9FUE9DSDogMTk0ODMyMC41XG59O1xuIiwiLyogZXNsaW50LWRpc2FibGUgbm8tdW51c2VkLXZhcnMgKi9cblxuaW1wb3J0IHtcbiAgTU9OVEhfTkFNRVMsXG4gIEFCQlJfREFZUyxcbiAgREFZU19OQU1FU1xufSBmcm9tICcuL2NvbnN0YW50cyc7XG5cbmV4cG9ydCBmdW5jdGlvbiBkaXYoYSwgYikge1xuICByZXR1cm4gTWF0aC5mbG9vcihhIC8gYik7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBtb2QoYSwgYikge1xuICByZXR1cm4gYSAtIChNYXRoLmZsb29yKGEgLyBiKSAqIGIpO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gZml4TW9udGgoeWVhciwgbW9udGgpIHtcbiAgaWYgKG1vbnRoID4gMTIgfHwgbW9udGggPD0gMCkge1xuICAgIGNvbnN0IHllYXJEaWZmID0gTWF0aC5mbG9vcigobW9udGggLSAxKSAvIDEyKTtcbiAgICBjb25zdCBuZXdZZWFyID0geWVhciAtIHllYXJEaWZmO1xuICAgIGNvbnN0IG5ld01vbnRoID0gbW9udGggLSAoeWVhckRpZmYgKiAxMik7XG5cbiAgICByZXR1cm4gW25ld1llYXIsIG5ld01vbnRoXTtcbiAgfVxuXG4gIHJldHVybiBbeWVhciwgbW9udGhdO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gemVyb0xlYWRpbmcoc3RyKSB7XG4gIGlmIChzdHIgJiYgc3RyLmxlbmd0aCA9PT0gMSkgeyByZXR1cm4gYDAke3N0cn1gOyB9XG4gIHJldHVybiBzdHI7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZXBsYWNlWWVhcihzdHIsIGRhdGUpIHtcbiAgY29uc3QgbWF0Y2ggPSBzdHIubWF0Y2goL1t5WV0rLyk7XG4gIGlmICghbWF0Y2gpIHsgcmV0dXJuIHN0cjsgfVxuICBzd2l0Y2ggKG1hdGNoWzBdKSB7XG4gICAgY2FzZSAnWVlZWSc6XG4gICAgY2FzZSAnWVlZJzoge1xuICAgICAgY29uc3QgdmFsdWUgPSByZXBsYWNlWWVhcihzdHIucmVwbGFjZShtYXRjaCwgZGF0ZS5nZXRGdWxsWWVhcigpKSwgZGF0ZSk7XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuICAgIGNhc2UgJ1lZJzoge1xuICAgICAgY29uc3QgdmFsdWUgPSByZXBsYWNlWWVhcihcbiAgICAgICAgc3RyLnJlcGxhY2UobWF0Y2gsIFN0cmluZyhkYXRlLmdldEZ1bGxZZWFyKCkpLnNsaWNlKDIpKSwgZGF0ZVxuICAgICAgKTtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG4gICAgZGVmYXVsdDoge1xuICAgICAgcmV0dXJuIHN0cjtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlcGxhY2VNb250aChzdHIsIGRhdGUpIHtcbiAgY29uc3QgbWF0Y2ggPSBzdHIubWF0Y2goL1ttTV0rLyk7XG4gIGlmICghbWF0Y2gpIHsgcmV0dXJuIHN0cjsgfVxuICBzd2l0Y2ggKG1hdGNoWzBdKSB7XG4gICAgY2FzZSAnTSc6IHtcbiAgICAgIGNvbnN0IHZhbHVlID0gcmVwbGFjZU1vbnRoKHN0ci5yZXBsYWNlKG1hdGNoLCBkYXRlLmdldE1vbnRoKCkpLCBkYXRlKTtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG4gICAgY2FzZSAnTU0nOiB7XG4gICAgICBjb25zdCB6ZXJvTGVhZGluZ01vbnRoID0gemVyb0xlYWRpbmcoZGF0ZS5nZXRNb250aCgpLnRvU3RyaW5nKCkpO1xuICAgICAgY29uc3QgdmFsdWUgPSByZXBsYWNlTW9udGgoc3RyLnJlcGxhY2UobWF0Y2gsIHplcm9MZWFkaW5nTW9udGgpLCBkYXRlKTtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG4gICAgY2FzZSAnTU1NJzpcbiAgICBjYXNlICdNTU1NJzoge1xuICAgICAgY29uc3QgdmFsdWUgPSByZXBsYWNlTW9udGgoXG4gICAgICAgIHN0ci5yZXBsYWNlKG1hdGNoLCBNT05USF9OQU1FU1tkYXRlLmdldE1vbnRoKCkgLSAxXSksIGRhdGVcbiAgICAgICk7XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuICAgIGRlZmF1bHQ6IHtcbiAgICAgIHJldHVybiBzdHI7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBmdW5jdGlvbiByZXBsYWNlRGF5KHN0ciwgZGF0ZSkge1xuICBjb25zdCBtYXRjaCA9IHN0ci5tYXRjaCgvW2REXSsvKTtcbiAgaWYgKCFtYXRjaCkgeyByZXR1cm4gc3RyOyB9XG4gIHN3aXRjaCAobWF0Y2hbMF0pIHtcbiAgICBjYXNlICdEJzoge1xuICAgICAgY29uc3QgdmFsdWUgPSByZXBsYWNlRGF5KHN0ci5yZXBsYWNlKG1hdGNoLCBkYXRlLmdldERhdGUoKSksIGRhdGUpO1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cbiAgICBjYXNlICdERCc6IHtcbiAgICAgIGNvbnN0IHplcm9MZWFkaW5nRGF0ZSA9IHplcm9MZWFkaW5nKGRhdGUuZ2V0RGF0ZSgpLnRvU3RyaW5nKCkpO1xuICAgICAgY29uc3QgdmFsdWUgPSByZXBsYWNlRGF5KHN0ci5yZXBsYWNlKG1hdGNoLCB6ZXJvTGVhZGluZ0RhdGUpLCBkYXRlKTtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG4gICAgY2FzZSAnZCc6XG4gICAgY2FzZSAnZGQnOiB7XG4gICAgICBjb25zdCB2YWx1ZSA9IHJlcGxhY2VEYXkoc3RyLnJlcGxhY2UobWF0Y2gsIEFCQlJfREFZU1tkYXRlLmdldERheSgpXSksIGRhdGUpO1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cbiAgICBjYXNlICdkZGQnOlxuICAgIGNhc2UgJ2RkZGQnOiB7XG4gICAgICBjb25zdCB2YWx1ZSA9IHJlcGxhY2VEYXkoc3RyLnJlcGxhY2UobWF0Y2gsIERBWVNfTkFNRVNbZGF0ZS5nZXREYXkoKV0pLCBkYXRlKTtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG4gICAgZGVmYXVsdDoge1xuICAgICAgcmV0dXJuIHN0cjtcbiAgICB9XG4gIH1cbn1cbiIsImltcG9ydCB7IG1vZCB9IGZyb20gJy4vaGVscGVycyc7XG5pbXBvcnQgeyBHUkVHT1JJQU5fRVBPQ0gsIFBFUlNJQU5fRVBPQ0ggfSBmcm9tICcuL2NvbnN0YW50cyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIENvbnZlcnRlciB7XG4gIC8vICBMRUFQX0dSRUdPUklBTiAgLS0gIElzIGEgZ2l2ZW4geWVhciBpbiB0aGUgR3JlZ29yaWFuIGNhbGVuZGFyIGEgbGVhcCB5ZWFyP1xuICBzdGF0aWMgbGVhcEdyZWdvcmlhbih5ZWFyKSB7XG4gICAgcmV0dXJuICgoeWVhciAlIDQpID09PSAwKVxuICAgICAgJiYgKCEoKCh5ZWFyICUgMTAwKSA9PT0gMCkgJiYgKCh5ZWFyICUgNDAwKSAhPT0gMCkpKTtcbiAgfVxuXG4gIC8vIEdSRUdPUklBTl9UT19KRCAgLS0gIERldGVybWluZSBKdWxpYW4gZGF5IG51bWJlciBmcm9tIEdyZWdvcmlhbiBjYWxlbmRhciBkYXRlXG4gIHN0YXRpYyBncmVnb3JpYW5Ub0p1bGlhbih5ZWFyLCBtb250aCwgZGF5KSB7XG4gICAgbGV0IHBhZDtcbiAgICBpZiAobW9udGggPD0gMikge1xuICAgICAgcGFkID0gMDtcbiAgICB9IGVsc2UgaWYgKENvbnZlcnRlci5sZWFwR3JlZ29yaWFuKHllYXIpKSB7XG4gICAgICBwYWQgPSAtMTtcbiAgICB9IGVsc2Uge1xuICAgICAgcGFkID0gLTI7XG4gICAgfVxuXG4gICAgcmV0dXJuIChHUkVHT1JJQU5fRVBPQ0ggLSAxKVxuICAgICAgKyAoMzY1ICogKHllYXIgLSAxKSlcbiAgICAgICsgTWF0aC5mbG9vcigoeWVhciAtIDEpIC8gNClcbiAgICAgICsgKC1NYXRoLmZsb29yKCh5ZWFyIC0gMSkgLyAxMDApKVxuICAgICAgKyBNYXRoLmZsb29yKCh5ZWFyIC0gMSkgLyA0MDApXG4gICAgICArIE1hdGguZmxvb3IoKCgoMzY3ICogbW9udGgpIC0gMzYyKSAvIDEyKSArIChwYWQgKyBkYXkpKTtcbiAgfVxuXG4gIC8vICBKRF9UT19HUkVHT1JJQU4gIC0tICBDYWxjdWxhdGUgR3JlZ29yaWFuIGNhbGVuZGFyIGRhdGUgZnJvbSBKdWxpYW4gZGF5XG4gIHN0YXRpYyBqdWxpYW5Ub0dyZWdvcmlhbihqZCkge1xuICAgIGNvbnN0IHdqZCA9IE1hdGguZmxvb3IoamQgLSAwLjUpICsgMC41O1xuICAgIGNvbnN0IGRlcG9jaCA9IHdqZCAtIEdSRUdPUklBTl9FUE9DSDtcbiAgICBjb25zdCBxdWFkcmljZW50ID0gTWF0aC5mbG9vcihkZXBvY2ggLyAxNDYwOTcpO1xuICAgIGNvbnN0IGRxYyA9IG1vZChkZXBvY2gsIDE0NjA5Nyk7XG4gICAgY29uc3QgY2VudCA9IE1hdGguZmxvb3IoZHFjIC8gMzY1MjQpO1xuICAgIGNvbnN0IGRjZW50ID0gbW9kKGRxYywgMzY1MjQpO1xuICAgIGNvbnN0IHF1YWQgPSBNYXRoLmZsb29yKGRjZW50IC8gMTQ2MSk7XG4gICAgY29uc3QgZHF1YWQgPSBtb2QoZGNlbnQsIDE0NjEpO1xuICAgIGNvbnN0IHlpbmRleCA9IE1hdGguZmxvb3IoZHF1YWQgLyAzNjUpO1xuICAgIGxldCB5ZWFyID0gKHF1YWRyaWNlbnQgKiA0MDApICsgKGNlbnQgKiAxMDApICsgKHF1YWQgKiA0KSArIHlpbmRleDtcbiAgICBpZiAoISgoY2VudCA9PT0gNCkgfHwgKHlpbmRleCA9PT0gNCkpKSB7IHllYXIgKz0gMTsgfVxuICAgIGNvbnN0IHllYXJkYXkgPSB3amQgLSBDb252ZXJ0ZXIuZ3JlZ29yaWFuVG9KdWxpYW4oeWVhciwgMSwgMSk7XG4gICAgbGV0IGxlYXBhZGo7XG4gICAgaWYgKHdqZCA8IENvbnZlcnRlci5ncmVnb3JpYW5Ub0p1bGlhbih5ZWFyLCAzLCAxKSkge1xuICAgICAgbGVhcGFkaiA9IDA7XG4gICAgfSBlbHNlIGlmIChDb252ZXJ0ZXIubGVhcEdyZWdvcmlhbih5ZWFyKSA/IDEgOiAyKSB7XG4gICAgICBsZWFwYWRqID0gMTtcbiAgICB9IGVsc2Uge1xuICAgICAgbGVhcGFkaiA9IDI7XG4gICAgfVxuICAgIGNvbnN0IG1vbnRoID0gTWF0aC5mbG9vcigoKCh5ZWFyZGF5ICsgbGVhcGFkaikgKiAxMikgKyAzNzMpIC8gMzY3KTtcbiAgICBjb25zdCBkYXkgPSAod2pkIC0gQ29udmVydGVyLmdyZWdvcmlhblRvSnVsaWFuKHllYXIsIG1vbnRoLCAxKSkgKyAxO1xuXG4gICAgcmV0dXJuIFt5ZWFyLCBtb250aCwgZGF5XTtcbiAgfVxuXG4gIC8vICBMRUFQX1BFUlNJQU4gIC0tICBJcyBhIGdpdmVuIHllYXIgYSBsZWFwIHllYXIgaW4gdGhlIFBlcnNpYW4gY2FsZW5kYXIgP1xuICBzdGF0aWMgbGVhcFBlcnNpYW4oeWVhcikge1xuICAgIHJldHVybiAoXG4gICAgICAoKCgoKHllYXIgLSAoKHllYXIgPiAwKSA/IDQ3NCA6IDQ3MykpICUgMjgyMCkgKyA0NzQpICsgMzgpICogNjgyKSAlIDI4MTZcbiAgICApIDwgNjgyO1xuICB9XG5cbiAgLy8gIFBFUlNJQU5fVE9fSkQgIC0tICBEZXRlcm1pbmUgSnVsaWFuIGRheSBmcm9tIFBlcnNpYW4gZGF0ZVxuICBzdGF0aWMgcGVyc2lhblRvSnVsaWFuKHllYXIsIG1vbnRoLCBkYXkpIHtcbiAgICBjb25zdCBlcGJhc2UgPSB5ZWFyIC0gKCh5ZWFyID49IDApID8gNDc0IDogNDczKTtcbiAgICBjb25zdCBlcHllYXIgPSA0NzQgKyBtb2QoZXBiYXNlLCAyODIwKTtcblxuICAgIHJldHVybiBkYXlcbiAgICAgICsgKChtb250aCA8PSA3KVxuICAgICAgICA/ICgobW9udGggLSAxKSAqIDMxKVxuICAgICAgICA6ICgoKG1vbnRoIC0gMSkgKiAzMCkgKyA2KVxuICAgICAgKVxuICAgICAgKyBNYXRoLmZsb29yKCgoZXB5ZWFyICogNjgyKSAtIDExMCkgLyAyODE2KVxuICAgICAgKyAoKGVweWVhciAtIDEpICogMzY1KVxuICAgICAgKyAoTWF0aC5mbG9vcihlcGJhc2UgLyAyODIwKSAqIDEwMjk5ODMpICsgKFBFUlNJQU5fRVBPQ0ggLSAxKTtcbiAgfVxuXG4gIC8vICBKRF9UT19QRVJTSUFOICAtLSAgQ2FsY3VsYXRlIFBlcnNpYW4gZGF0ZSBmcm9tIEp1bGlhbiBkYXlcbiAgc3RhdGljIGp1bGlhblRvUGVyc2lhbihqZCkge1xuICAgIGNvbnN0IG5qZCA9IE1hdGguZmxvb3IoamQpICsgMC41O1xuICAgIGNvbnN0IGRlcG9jaCA9IG5qZCAtIENvbnZlcnRlci5wZXJzaWFuVG9KdWxpYW4oNDc1LCAxLCAxKTtcbiAgICBjb25zdCBjeWNsZSA9IE1hdGguZmxvb3IoZGVwb2NoIC8gMTAyOTk4Myk7XG4gICAgY29uc3QgY3llYXIgPSBtb2QoZGVwb2NoLCAxMDI5OTgzKTtcbiAgICBsZXQgeWN5Y2xlO1xuICAgIGlmIChjeWVhciA9PT0gMTAyOTk4Mikge1xuICAgICAgeWN5Y2xlID0gMjgyMDtcbiAgICB9IGVsc2Uge1xuICAgICAgY29uc3QgYXV4MSA9IE1hdGguZmxvb3IoY3llYXIgLyAzNjYpO1xuICAgICAgY29uc3QgYXV4MiA9IG1vZChjeWVhciwgMzY2KTtcbiAgICAgIHljeWNsZSA9IE1hdGguZmxvb3IoKCgyMTM0ICogYXV4MSkgKyAoMjgxNiAqIGF1eDIpICsgMjgxNSkgLyAxMDI4NTIyKVxuICAgICAgICArIGF1eDEgKyAxO1xuICAgIH1cbiAgICBsZXQgeWVhciA9IHljeWNsZSArICgyODIwICogY3ljbGUpICsgNDc0O1xuICAgIGlmICh5ZWFyIDw9IDApIHtcbiAgICAgIHllYXIgLT0gMTtcbiAgICB9XG4gICAgY29uc3QgeWRheSA9IChuamQgLSBDb252ZXJ0ZXIucGVyc2lhblRvSnVsaWFuKHllYXIsIDEsIDEpKSArIDE7XG4gICAgY29uc3QgbW9udGggPSAoeWRheSA8PSAxODYpID8gTWF0aC5jZWlsKHlkYXkgLyAzMSkgOiBNYXRoLmNlaWwoKHlkYXkgLSA2KSAvIDMwKTtcbiAgICBjb25zdCBkYXkgPSAobmpkIC0gQ29udmVydGVyLnBlcnNpYW5Ub0p1bGlhbih5ZWFyLCBtb250aCwgMSkpICsgMTtcblxuICAgIHJldHVybiBbeWVhciwgbW9udGgsIGRheV07XG4gIH1cblxuICBzdGF0aWMgcGVyc2lhblRvR3JlZ29yaWFuKHllYXIsIG1vbnRoLCBkYXkpIHtcbiAgICBjb25zdCBqdWxpYW4gPSBDb252ZXJ0ZXIucGVyc2lhblRvSnVsaWFuKHllYXIsIG1vbnRoLCBkYXkpO1xuXG4gICAgcmV0dXJuIENvbnZlcnRlci5qdWxpYW5Ub0dyZWdvcmlhbihqdWxpYW4pO1xuICB9XG5cbiAgc3RhdGljIGdyZWdvcmlhblRvUGVyc2lhbih5ZWFyLCBtb250aCwgZGF5KSB7XG4gICAgY29uc3QganVsaWFuID0gQ29udmVydGVyLmdyZWdvcmlhblRvSnVsaWFuKHllYXIsIG1vbnRoLCBkYXkpO1xuXG4gICAgcmV0dXJuIENvbnZlcnRlci5qdWxpYW5Ub1BlcnNpYW4oanVsaWFuKTtcbiAgfVxufVxuIiwiLypcbiAqIGh0dHBzOi8vZ2l0aHViLmNvbS9hcmFzaG0vSkRhdGVcbiAqIEBhdXRob3I6IEFyYXNoIE1vdXNhdmlcbiAqIEB2ZXJzaW9uOiAxLjAuMFxuICovXG5cbmltcG9ydCBDb252ZXJ0ZXIgZnJvbSAnLi9jb252ZXJ0ZXInO1xuaW1wb3J0ICogYXMgaGVscGVycyBmcm9tICcuL2hlbHBlcnMnO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBKRGF0ZSB7XG4gIGNvbnN0cnVjdG9yKGlucHV0ID0gbmV3IERhdGUoKSkge1xuICAgIHRoaXMuaW5wdXQgPSBpbnB1dDtcbiAgICBpZiAoQXJyYXkuaXNBcnJheShpbnB1dCkpIHtcbiAgICAgIHRoaXMuZGF0ZSA9IGlucHV0Lm1hcCgobnVtKSA9PiBwYXJzZUludChudW0sIDEwKSk7XG4gICAgICB0aGlzLl9kID0gdGhpcy50b0dyZWdvcmlhbigpO1xuICAgIH0gZWxzZSBpZiAoaW5wdXQgaW5zdGFuY2VvZiBEYXRlKSB7XG4gICAgICB0aGlzLl9kID0gaW5wdXQ7XG4gICAgICB0aGlzLmRhdGUgPSBKRGF0ZS50b0phbGFsaSh0aGlzLmlucHV0KTtcbiAgICB9XG4gIH1cblxuICAvKlxuICAgKiBDb3ZlcnRzIGEgR3JlZ29yaWFuIGRhdGUgdG8gSmFsYWxpIGRhdGVcbiAgICpcbiAgICogQHBhcmFtcyB7RGF0ZX0gZGF0ZVxuICAgKiBAcmV0dXJuIHtBcnJheX1cbiAgICovXG4gIHN0YXRpYyB0b0phbGFsaShkYXRlKSB7XG4gICAgY29uc3QganVsaWFuRGF0ZSA9IENvbnZlcnRlci5ncmVnb3JpYW5Ub0p1bGlhbihcbiAgICAgIGRhdGUuZ2V0RnVsbFllYXIoKSxcbiAgICAgIGRhdGUuZ2V0TW9udGgoKSArIDEsXG4gICAgICBkYXRlLmdldERhdGUoKSxcbiAgICApO1xuICAgIGNvbnN0IGpkYXRlID0gQ29udmVydGVyLmp1bGlhblRvUGVyc2lhbihqdWxpYW5EYXRlKTtcblxuICAgIHJldHVybiBqZGF0ZTtcbiAgfVxuXG4gIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBjYW1lbGNhc2VcbiAgc3RhdGljIHRvX2phbGFsaShkYXRlKSB7IHJldHVybiBKRGF0ZS50b0phbGFsaShkYXRlKTsgfVxuXG4gIC8qXG4gICAqIGNvbnZlcnRzIGEgSmFsYWxpIGRhdGUgdG8gR3JlZ29yaWFuXG4gICAqXG4gICAqIEBwYXJhbXMge051bWJlcn0geWVhclxuICAgKiBAcGFyYW1zIHtOdW1iZXJ9IG1vbnRoXG4gICAqIEBwYXJhbXMge051bWJlcn0gZGF5XG4gICAqIEByZXR1cm4ge0RhdGV9XG4gICAqL1xuICBzdGF0aWMgdG9HcmVnb3JpYW4oeWVhciwgbW9udGgsIGRheSkge1xuICAgIGNvbnN0IGdkYXRlID0gQ29udmVydGVyLmp1bGlhblRvR3JlZ29yaWFuKFxuICAgICAgQ29udmVydGVyLnBlcnNpYW5Ub0p1bGlhbih5ZWFyLCBtb250aCwgZGF5KVxuICAgICk7XG5cbiAgICByZXR1cm4gbmV3IERhdGUoZ2RhdGVbMF0sIGdkYXRlWzFdIC0gMSwgZ2RhdGVbMl0pO1xuICB9XG5cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGNhbWVsY2FzZVxuICBzdGF0aWMgdG9fZ3JlZ29yaWFuKHllYXIsIG1vbnRoLCBkYXkpIHsgcmV0dXJuIEpEYXRlLnRvR3JlZ29yaWFuKHllYXIsIG1vbnRoLCBkYXkpOyB9XG5cbiAgLypcbiAgICogQ2hlY2tzIGlmIGEgZ2l2ZW4geWVhciBpcyBhIGxlYXAgeWVhciBvciBub3RcbiAgICpcbiAgICogQHBhcmFtcyB7TnVtYmVyfSB5ZWFyXG4gICAqIEByZXR1cm4ge0Jvb2xlYW59XG4gICAqL1xuICBzdGF0aWMgaXNMZWFwWWVhcih5ZWFyKSB7XG4gICAgcmV0dXJuIENvbnZlcnRlci5sZWFwUGVyc2lhbih5ZWFyKTtcbiAgfVxuXG4gIC8qXG4gICAqIFJldHVybnMgbW9udGggbGVuZ3RoLlxuICAgKlxuICAgKiBAcGFyYW1zIHtOdW1iZXJ9IHllYXJcbiAgICogQHBhcmFtcyB7TnVtYmVyfSBtb250aCB6ZXJvIGJhc2VkXG4gICAqIEByZXR1cm4ge051bWJlcn1cbiAgICovXG4gIHN0YXRpYyBkYXlzSW5Nb250aCh5ZWFyLCBtb250aCkge1xuICAgIGxldCBjYWxjZWRZZWFyID0geWVhciAtIE1hdGguZmxvb3IobW9udGggLyAxMik7XG4gICAgbGV0IGNhbGNlZE1vbnRoID0gbW9udGggLSAoTWF0aC5mbG9vcihtb250aCAvIDEyKSAqIDEyKTtcblxuICAgIGlmIChjYWxjZWRNb250aCA8IDApIHtcbiAgICAgIGNhbGNlZE1vbnRoICs9IDEyO1xuICAgICAgY2FsY2VkWWVhciAtPSAxO1xuICAgIH0gZWxzZSBpZiAoY2FsY2VkTW9udGggPT09IDApIHtcbiAgICAgIGNhbGNlZE1vbnRoID0gMTI7XG4gICAgfVxuXG4gICAgaWYgKGNhbGNlZE1vbnRoIDwgNikge1xuICAgICAgcmV0dXJuIDMxO1xuICAgIH0gaWYgKGNhbGNlZE1vbnRoIDwgMTEpIHtcbiAgICAgIHJldHVybiAzMDtcbiAgICB9IGlmIChKRGF0ZS5pc0xlYXBZZWFyKGNhbGNlZFllYXIpKSB7XG4gICAgICByZXR1cm4gMzA7XG4gICAgfVxuICAgIHJldHVybiAyOTtcbiAgfVxuXG4gIC8qXG4gICAqIENvbnZlcnRzIEpEYXRlIGRhdGUgdG8gR3JlZ29yaWFuXG4gICAqL1xuICB0b0dyZWdvcmlhbigpIHtcbiAgICByZXR1cm4gSkRhdGUudG9HcmVnb3JpYW4odGhpcy5kYXRlWzBdLCB0aGlzLmRhdGVbMV0sIHRoaXMuZGF0ZVsyXSk7XG4gIH1cblxuICAvKlxuICAgKiBTaG93cyBKYWxhbGkncyBmdWxsIHllYXIsIGV4OiAxMzkzXG4gICAqXG4gICAqIEByZXR1cm4ge0ludGVnZXJ9XG4gICAqL1xuICBnZXRGdWxsWWVhcigpIHtcbiAgICByZXR1cm4gdGhpcy5kYXRlWzBdO1xuICB9XG5cbiAgLypcbiAgICogU2V0cyB0aGUgSmFsYWxpIGZ1bGwgeWVhclxuICAgKlxuICAgKiBAcGFyYW1zIHtOdW1iZXJ9IHllYXJcbiAgICogQHJldHVybiB7SkRhdGV9XG4gICAqL1xuICBzZXRGdWxsWWVhcih5ZWFyKSB7XG4gICAgdGhpcy5kYXRlWzBdID0gcGFyc2VJbnQoeWVhciwgMTApO1xuICAgIHRoaXMuaW5wdXQgPSB0aGlzLnRvR3JlZ29yaWFuKCk7XG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKlxuICAgKiBTaG93cyBKYWxhbGkgbW9udGggbnVtYmVyLlxuICAgKlxuICAgKiBAcmV0dXJuIHtOdW1iZXJ9IEphbGFsaSBtb250aCBudW1iZXJcbiAgICovXG4gIGdldE1vbnRoKCkge1xuICAgIHJldHVybiB0aGlzLmRhdGVbMV07XG4gIH1cblxuICAvKlxuICAgKiBTZXRzIHRoZSBKYWxhbGkgbW9udGggbnVtYmVyLiBBbiBpbnRlZ2VyIGJldHdlZW4gMCBhbmQgMTFcbiAgICpcbiAgICogQHBhcmFtcyB7TnVtYmVyfSBtb250aFxuICAgKiBAcmV0dXJucyB7SkRhdGV9XG4gICAqL1xuICBzZXRNb250aChtb250aCkge1xuICAgIGNvbnN0IGZpeGVkID0gaGVscGVycy5maXhNb250aCh0aGlzLmdldEZ1bGxZZWFyKCksIHBhcnNlSW50KG1vbnRoLCAxMCkpO1xuICAgIFt0aGlzLmRhdGVbMF0sIHRoaXMuZGF0ZVsxXV0gPSBmaXhlZDtcbiAgICB0aGlzLmlucHV0ID0gdGhpcy50b0dyZWdvcmlhbigpO1xuXG4gICAgcmV0dXJuIHRoaXM7XG4gIH1cblxuICAvKlxuICAgKiBTaG93cyBKYWxhbGkgZGF5IG51bWJlci4gQSBudW1iZXIgYmV0d2VlbiAwIHRvIDMxXG4gICAqXG4gICAqIEByZXR1cm4ge051bWJlcn0gSmFsYWxpIGRheSBudW1iZXJcbiAgICovXG4gIGdldERhdGUoKSB7XG4gICAgcmV0dXJuIHRoaXMuZGF0ZVsyXTtcbiAgfVxuXG4gIC8qXG4gICAqIFNldHMgSmFsYWxpIGRheSBudW1iZXIuIEEgbnVtYmVyIGJldHdlZW4gMCB0byAzMVxuICAgKlxuICAgKiBAcGFyYW1zIHtOdW1iZXJ9IGRhdGVcbiAgICogQHJldHVybiB7SkRhdGV9XG4gICAqL1xuICBzZXREYXRlKGRhdGUpIHtcbiAgICB0aGlzLmRhdGVbMl0gPSBwYXJzZUludChkYXRlLCAxMCk7XG4gICAgdGhpcy5pbnB1dCA9IHRoaXMudG9HcmVnb3JpYW4oKTtcblxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLypcbiAgICogUmV0dXJucyB0aGUgZGF5IG9mIHRoZSB3ZWVrIGZvciB0aGUgc3BlY2lmaWVkIGRhdGUuIEEgbnVtYmVyIGJldHdlZW4gMCB0byA2XG4gICAqXG4gICAqIEByZXR1cm5zIHtOdW1iZXJ9XG4gICAqL1xuICBnZXREYXkoKSB7XG4gICAgcmV0dXJuIHRoaXMuX2QuZ2V0RGF5KCk7XG4gIH1cblxuICAvKlxuICAgKiBSZXR1cm5zIGEgZm9ybWF0ZWQgb3V0cHV0IG9mIGN1cnJlbnQgZGF0ZVxuICAgKlxuICAgKiBAcGFyYW1zIHtTdHJpbmd9IGZvcm1hdFxuICAgKiBAcmV0dXJuIHtTdHJpbmd9XG4gICAqL1xuICBmb3JtYXQoZm9ybWF0KSB7XG4gICAgbGV0IHJlc3VsdCA9IGhlbHBlcnMucmVwbGFjZVllYXIoZm9ybWF0LCB0aGlzKTtcbiAgICByZXN1bHQgPSBoZWxwZXJzLnJlcGxhY2VNb250aChyZXN1bHQsIHRoaXMpO1xuICAgIHJlc3VsdCA9IGhlbHBlcnMucmVwbGFjZURheShyZXN1bHQsIHRoaXMpO1xuXG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxufVxuIl0sInNvdXJjZVJvb3QiOiIifQ==
