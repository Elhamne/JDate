!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("JDate",[],t):"object"==typeof exports?exports.JDate=t():e.JDate=t()}(this,function(){return function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e,t){e.exports={MONTH_NAMES:["فروردین","اردیبهشت","خرداد","تیر","امرداد","شهریور","مهر","آبان","آذر","دی","بهمن","اسفند"],ABBR_DAYS:["۱ش","۲ش","۳ش","۴ش","۵ش","ج","ش"],DAYS_NAMES:["یکشنبه","دوشنبه","سه‌شنبه","چهارشنبه","پنج‌شنبه","جمعه","شنبه"],GREGORIAN_EPOCH:1721425.5,PERSIAN_EPOCH:1948320.5}},function(e,t,r){"use strict";r.r(t);var n=r(0);function a(e,t){return e-Math.floor(e/t)*t}function o(e){return e&&1===e.length?"0".concat(e):e}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var u=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e)}var t,r,o;return t=e,o=[{key:"leapGregorian",value:function(e){return e%4==0&&!(e%100==0&&e%400!=0)}},{key:"gregorianToJulian",value:function(t,r,a){var o;return o=r<=2?0:e.leapGregorian(t)?-1:-2,n.GREGORIAN_EPOCH-1+365*(t-1)+Math.floor((t-1)/4)+-Math.floor((t-1)/100)+Math.floor((t-1)/400)+Math.floor((367*r-362)/12+(o+a))}},{key:"julianToGregorian",value:function(t){var r=Math.floor(t-.5)+.5,o=r-n.GREGORIAN_EPOCH,i=Math.floor(o/146097),u=a(o,146097),l=Math.floor(u/36524),f=a(u,36524),c=Math.floor(f/1461),s=a(f,1461),h=Math.floor(s/365),p=400*i+100*l+4*c+h;4!==l&&4!==h&&(p+=1);var v,g=r-e.gregorianToJulian(p,1,1);v=r<e.gregorianToJulian(p,3,1)?0:(e.leapGregorian(p),1);var d=Math.floor((12*(g+v)+373)/367);return[p,d,r-e.gregorianToJulian(p,d,1)+1]}},{key:"leapPersian",value:function(e){return 682*((e-(e>0?474:473))%2820+474+38)%2816<682}},{key:"persianToJulian",value:function(e,t,r){var o=e-(e>=0?474:473),i=474+a(o,2820);return r+(t<=7?31*(t-1):30*(t-1)+6)+Math.floor((682*i-110)/2816)+365*(i-1)+1029983*Math.floor(o/2820)+(n.PERSIAN_EPOCH-1)}},{key:"julianToPersian",value:function(t){var r,n=Math.floor(t)+.5,o=n-e.persianToJulian(475,1,1),i=Math.floor(o/1029983),u=a(o,1029983);if(1029982===u)r=2820;else{var l=Math.floor(u/366),f=a(u,366);r=Math.floor((2134*l+2816*f+2815)/1028522)+l+1}var c=r+2820*i+474;c<=0&&(c-=1);var s=n-e.persianToJulian(c,1,1)+1,h=s<=186?Math.ceil(s/31):Math.ceil((s-6)/30);return[c,h,n-e.persianToJulian(c,h,1)+1]}},{key:"persianToGregorian",value:function(t,r,n){var a=e.persianToJulian(t,r,n);return e.julianToGregorian(a)}},{key:"gregorianToPersian",value:function(t,r,n){var a=e.gregorianToJulian(t,r,n);return e.julianToPersian(a)}}],(r=null)&&i(t.prototype,r),o&&i(t,o),e}();function l(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}r.d(t,"default",function(){return f});var f=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.input=t,Array.isArray(t)?(this.date=t.map(function(e){return parseInt(e,10)}),this._d=this.toGregorian()):t instanceof Date&&(this._d=t,this.date=e.toJalali(this.input))}var t,r,a;return t=e,a=[{key:"toJalali",value:function(e){var t=u.gregorianToJulian(e.getFullYear(),e.getMonth()+1,e.getDate());return u.julianToPersian(t)}},{key:"to_jalali",value:function(t){return e.toJalali(t)}},{key:"toGregorian",value:function(e,t,r){var n=u.julianToGregorian(u.persianToJulian(e,t,r));return new Date(n[0],n[1]-1,n[2])}},{key:"to_gregorian",value:function(t,r,n){return e.toGregorian(t,r,n)}},{key:"isLeapYear",value:function(e){return u.leapPersian(e)}},{key:"daysInMonth",value:function(t,r){var n=t-Math.floor(r/12),a=r-12*Math.floor(r/12);return a<0?(a+=12,n-=1):0===a&&(a=12),a<6?31:a<11?30:e.isLeapYear(n)?30:29}}],(r=[{key:"toGregorian",value:function(){return e.toGregorian(this.date[0],this.date[1],this.date[2])}},{key:"getFullYear",value:function(){return this.date[0]}},{key:"setFullYear",value:function(e){return this.date[0]=parseInt(e,10),this.input=this.toGregorian(),this}},{key:"getMonth",value:function(){return this.date[1]}},{key:"setMonth",value:function(e){var t=function(e,t){if(t>12||t<=0){var r=Math.floor((t-1)/12);return[e-r,t-12*r]}return[e,t]}(this.getFullYear(),parseInt(e,10));return this.date[0]=t[0],this.date[1]=t[1],this.input=this.toGregorian(),this}},{key:"getDate",value:function(){return this.date[2]}},{key:"setDate",value:function(e){return this.date[2]=parseInt(e,10),this.input=this.toGregorian(),this}},{key:"getDay",value:function(){return this._d.getDay()}},{key:"format",value:function(e){var t=function e(t,r){var n=t.match(/[yY]+/);if(!n)return t;switch(n[0]){case"YYYY":case"YYY":return e(t.replace(n,r.getFullYear()),r);case"YY":return e(t.replace(n,String(r.getFullYear()).slice(2)),r);default:return t}}(e,this);return t=function e(t,r){var a=t.match(/[dD]+/);if(!a)return t;switch(a[0]){case"D":return e(t.replace(a,r.getDate()),r);case"DD":var i=o(r.getDate().toString());return e(t.replace(a,i),r);case"d":case"dd":return e(t.replace(a,n.ABBR_DAYS[r.getDay()]),r);case"ddd":case"dddd":return e(t.replace(a,n.DAYS_NAMES[r.getDay()]),r);default:return t}}(t=function e(t,r){var a=t.match(/[mM]+/);if(!a)return t;switch(a[0]){case"M":return e(t.replace(a,r.getMonth()),r);case"MM":var i=o(r.getMonth().toString());return e(t.replace(a,i),r);case"MMM":case"MMMM":return e(t.replace(a,n.MONTH_NAMES[r.getMonth()-1]),r);default:return t}}(t,this),this)}}])&&l(t.prototype,r),a&&l(t,a),e}()}]).default});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9KRGF0ZS93ZWJwYWNrL3VuaXZlcnNhbE1vZHVsZURlZmluaXRpb24iLCJ3ZWJwYWNrOi8vSkRhdGUvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vSkRhdGUvLi9zcmMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL0pEYXRlLy4vc3JjL2hlbHBlcnMuanMiLCJ3ZWJwYWNrOi8vSkRhdGUvLi9zcmMvY29udmVydGVyLmpzIiwid2VicGFjazovL0pEYXRlLy4vc3JjL2pkYXRlLmpzIl0sIm5hbWVzIjpbInJvb3QiLCJmYWN0b3J5IiwiZXhwb3J0cyIsIm1vZHVsZSIsImRlZmluZSIsImFtZCIsInRoaXMiLCJpbnN0YWxsZWRNb2R1bGVzIiwiX193ZWJwYWNrX3JlcXVpcmVfXyIsIm1vZHVsZUlkIiwiaSIsImwiLCJtb2R1bGVzIiwiY2FsbCIsIm0iLCJjIiwiZCIsIm5hbWUiLCJnZXR0ZXIiLCJvIiwiT2JqZWN0IiwiZGVmaW5lUHJvcGVydHkiLCJlbnVtZXJhYmxlIiwiZ2V0IiwiciIsIlN5bWJvbCIsInRvU3RyaW5nVGFnIiwidmFsdWUiLCJ0IiwibW9kZSIsIl9fZXNNb2R1bGUiLCJucyIsImNyZWF0ZSIsImtleSIsImJpbmQiLCJuIiwib2JqZWN0IiwicHJvcGVydHkiLCJwcm90b3R5cGUiLCJoYXNPd25Qcm9wZXJ0eSIsInAiLCJzIiwiTU9OVEhfTkFNRVMiLCJBQkJSX0RBWVMiLCJEQVlTX05BTUVTIiwiR1JFR09SSUFOX0VQT0NIIiwiUEVSU0lBTl9FUE9DSCIsIm1vZCIsImEiLCJiIiwiTWF0aCIsImZsb29yIiwiemVyb0xlYWRpbmciLCJzdHIiLCJsZW5ndGgiLCJDb252ZXJ0ZXIiLCJ5ZWFyIiwibW9udGgiLCJkYXkiLCJwYWQiLCJsZWFwR3JlZ29yaWFuIiwiamQiLCJ3amQiLCJkZXBvY2giLCJxdWFkcmljZW50IiwiZHFjIiwiY2VudCIsImRjZW50IiwicXVhZCIsImRxdWFkIiwieWluZGV4IiwibGVhcGFkaiIsInllYXJkYXkiLCJncmVnb3JpYW5Ub0p1bGlhbiIsImVwYmFzZSIsImVweWVhciIsInljeWNsZSIsIm5qZCIsInBlcnNpYW5Ub0p1bGlhbiIsImN5Y2xlIiwiY3llYXIiLCJhdXgxIiwiYXV4MiIsInlkYXkiLCJjZWlsIiwianVsaWFuIiwianVsaWFuVG9HcmVnb3JpYW4iLCJqdWxpYW5Ub1BlcnNpYW4iLCJKRGF0ZSIsImlucHV0IiwiRGF0ZSIsIkFycmF5IiwiaXNBcnJheSIsImRhdGUiLCJtYXAiLCJudW0iLCJwYXJzZUludCIsIl9kIiwidG9HcmVnb3JpYW4iLCJ0b0phbGFsaSIsImp1bGlhbkRhdGUiLCJnZXRGdWxsWWVhciIsImdldE1vbnRoIiwiZ2V0RGF0ZSIsImdkYXRlIiwibGVhcFBlcnNpYW4iLCJjYWxjZWRZZWFyIiwiY2FsY2VkTW9udGgiLCJpc0xlYXBZZWFyIiwiZml4ZWQiLCJ5ZWFyRGlmZiIsImhlbHBlcnMiLCJnZXREYXkiLCJmb3JtYXQiLCJyZXN1bHQiLCJyZXBsYWNlWWVhciIsIm1hdGNoIiwicmVwbGFjZSIsIlN0cmluZyIsInNsaWNlIiwicmVwbGFjZURheSIsInplcm9MZWFkaW5nRGF0ZSIsInRvU3RyaW5nIiwicmVwbGFjZU1vbnRoIiwiemVyb0xlYWRpbmdNb250aCJdLCJtYXBwaW5ncyI6IkNBQUEsU0FBMkNBLEVBQU1DLEdBQzFCLGlCQUFaQyxTQUEwQyxpQkFBWEMsT0FDeENBLE9BQU9ELFFBQVVELElBQ1EsbUJBQVhHLFFBQXlCQSxPQUFPQyxJQUM5Q0QsT0FBTyxRQUFTLEdBQUlILEdBQ00saUJBQVpDLFFBQ2RBLFFBQWUsTUFBSUQsSUFFbkJELEVBQVksTUFBSUMsSUFSbEIsQ0FTR0ssS0FBTSxXQUNULE8sWUNURSxJQUFJQyxFQUFtQixHQUd2QixTQUFTQyxFQUFvQkMsR0FHNUIsR0FBR0YsRUFBaUJFLEdBQ25CLE9BQU9GLEVBQWlCRSxHQUFVUCxRQUduQyxJQUFJQyxFQUFTSSxFQUFpQkUsR0FBWSxDQUN6Q0MsRUFBR0QsRUFDSEUsR0FBRyxFQUNIVCxRQUFTLElBVVYsT0FOQVUsRUFBUUgsR0FBVUksS0FBS1YsRUFBT0QsUUFBU0MsRUFBUUEsRUFBT0QsUUFBU00sR0FHL0RMLEVBQU9RLEdBQUksRUFHSlIsRUFBT0QsUUEwRGYsT0FyREFNLEVBQW9CTSxFQUFJRixFQUd4QkosRUFBb0JPLEVBQUlSLEVBR3hCQyxFQUFvQlEsRUFBSSxTQUFTZCxFQUFTZSxFQUFNQyxHQUMzQ1YsRUFBb0JXLEVBQUVqQixFQUFTZSxJQUNsQ0csT0FBT0MsZUFBZW5CLEVBQVNlLEVBQU0sQ0FBRUssWUFBWSxFQUFNQyxJQUFLTCxLQUtoRVYsRUFBb0JnQixFQUFJLFNBQVN0QixHQUNYLG9CQUFYdUIsUUFBMEJBLE9BQU9DLGFBQzFDTixPQUFPQyxlQUFlbkIsRUFBU3VCLE9BQU9DLFlBQWEsQ0FBRUMsTUFBTyxXQUU3RFAsT0FBT0MsZUFBZW5CLEVBQVMsYUFBYyxDQUFFeUIsT0FBTyxLQVF2RG5CLEVBQW9Cb0IsRUFBSSxTQUFTRCxFQUFPRSxHQUV2QyxHQURVLEVBQVBBLElBQVVGLEVBQVFuQixFQUFvQm1CLElBQy9CLEVBQVBFLEVBQVUsT0FBT0YsRUFDcEIsR0FBVyxFQUFQRSxHQUE4QixpQkFBVkYsR0FBc0JBLEdBQVNBLEVBQU1HLFdBQVksT0FBT0gsRUFDaEYsSUFBSUksRUFBS1gsT0FBT1ksT0FBTyxNQUd2QixHQUZBeEIsRUFBb0JnQixFQUFFTyxHQUN0QlgsT0FBT0MsZUFBZVUsRUFBSSxVQUFXLENBQUVULFlBQVksRUFBTUssTUFBT0EsSUFDdEQsRUFBUEUsR0FBNEIsaUJBQVRGLEVBQW1CLElBQUksSUFBSU0sS0FBT04sRUFBT25CLEVBQW9CUSxFQUFFZSxFQUFJRSxFQUFLLFNBQVNBLEdBQU8sT0FBT04sRUFBTU0sSUFBUUMsS0FBSyxLQUFNRCxJQUM5SSxPQUFPRixHQUlSdkIsRUFBb0IyQixFQUFJLFNBQVNoQyxHQUNoQyxJQUFJZSxFQUFTZixHQUFVQSxFQUFPMkIsV0FDN0IsV0FBd0IsT0FBTzNCLEVBQWdCLFNBQy9DLFdBQThCLE9BQU9BLEdBRXRDLE9BREFLLEVBQW9CUSxFQUFFRSxFQUFRLElBQUtBLEdBQzVCQSxHQUlSVixFQUFvQlcsRUFBSSxTQUFTaUIsRUFBUUMsR0FBWSxPQUFPakIsT0FBT2tCLFVBQVVDLGVBQWUxQixLQUFLdUIsRUFBUUMsSUFHekc3QixFQUFvQmdDLEVBQUksR0FJakJoQyxFQUFvQkEsRUFBb0JpQyxFQUFJLEcsZ0JDbEZyRHRDLEVBQU9ELFFBQVUsQ0FDZndDLFlBQWEsQ0FBQyxVQUFXLFdBQVksUUFBUyxNQUFPLFNBQVUsU0FBVSxNQUFPLE9BQVEsTUFBTyxLQUFNLE9BQVEsU0FDN0dDLFVBQVcsQ0FBQyxLQUFNLEtBQU0sS0FBTSxLQUFNLEtBQU0sSUFBSyxLQUMvQ0MsV0FBWSxDQUFDLFNBQVUsU0FBVSxVQUFXLFdBQVksV0FBWSxPQUFRLFFBQzVFQyxnQkFBaUIsVUFDakJDLGNBQWUsWSwrQ0NPVixTQUFTQyxFQUFJQyxFQUFHQyxHQUNyQixPQUFPRCxFQUFLRSxLQUFLQyxNQUFNSCxFQUFJQyxHQUFLQSxFQWUzQixTQUFTRyxFQUFZQyxHQUMxQixPQUFJQSxHQUFzQixJQUFmQSxFQUFJQyxPQUFnQixXQUFXRCxHQUNuQ0EsRSwwS0MzQllFLEUsMExBRUVDLEdBQ25CLE9BQVNBLEVBQU8sR0FBTyxLQUNiQSxFQUFPLEtBQVMsR0FBUUEsRUFBTyxLQUFTLEssd0NBSTNCQSxFQUFNQyxFQUFPQyxHQUNwQyxJQUFJQyxFQVNKLE9BUEVBLEVBREVGLEdBQVMsRUFDTCxFQUNHRixFQUFVSyxjQUFjSixJQUMxQixHQUVBLEVBR0RYLGtCQUFrQixFQUNyQixLQUFPVyxFQUFPLEdBQ2ZOLEtBQUtDLE9BQU9LLEVBQU8sR0FBSyxJQUN0Qk4sS0FBS0MsT0FBT0ssRUFBTyxHQUFLLEtBQzFCTixLQUFLQyxPQUFPSyxFQUFPLEdBQUssS0FDeEJOLEtBQUtDLE9BQVMsSUFBTU0sRUFBUyxLQUFPLElBQU9FLEVBQU1ELE0sd0NBSTlCRyxHQUN2QixJQUFNQyxFQUFNWixLQUFLQyxNQUFNVSxFQUFLLElBQU8sR0FDN0JFLEVBQVNELEVBQU1qQixrQkFDZm1CLEVBQWFkLEtBQUtDLE1BQU1ZLEVBQVMsUUFDakNFLEVBQU1sQixFQUFJZ0IsRUFBUSxRQUNsQkcsRUFBT2hCLEtBQUtDLE1BQU1jLEVBQU0sT0FDeEJFLEVBQVFwQixFQUFJa0IsRUFBSyxPQUNqQkcsRUFBT2xCLEtBQUtDLE1BQU1nQixFQUFRLE1BQzFCRSxFQUFRdEIsRUFBSW9CLEVBQU8sTUFDbkJHLEVBQVNwQixLQUFLQyxNQUFNa0IsRUFBUSxLQUM5QmIsRUFBcUIsSUFBYlEsRUFBNEIsSUFBUEUsRUFBc0IsRUFBUEUsRUFBWUUsRUFDNUMsSUFBVEosR0FBMkIsSUFBWEksSUFBa0JkLEdBQVEsR0FDakQsSUFDSWUsRUFERUMsRUFBVVYsRUFBTVAsRUFBVWtCLGtCQUFrQmpCLEVBQU0sRUFBRyxHQUd6RGUsRUFERVQsRUFBTVAsRUFBVWtCLGtCQUFrQmpCLEVBQU0sRUFBRyxHQUNuQyxHQUNERCxFQUFVSyxjQUFjSixHQUN2QixHQUlaLElBQU1DLEVBQVFQLEtBQUtDLE9BQThCLElBQXJCcUIsRUFBVUQsR0FBaUIsS0FBTyxLQUc5RCxNQUFPLENBQUNmLEVBQU1DLEVBRkRLLEVBQU1QLEVBQVVrQixrQkFBa0JqQixFQUFNQyxFQUFPLEdBQU0sSyxrQ0FNakRELEdBQ2pCLE9BQytELE1BQXhEQSxHQUFTQSxFQUFPLEVBQUssSUFBTSxNQUFRLEtBQVEsSUFBTyxJQUFhLEtBQ2xFLE0sc0NBSWlCQSxFQUFNQyxFQUFPQyxHQUNsQyxJQUFNZ0IsRUFBU2xCLEdBQVNBLEdBQVEsRUFBSyxJQUFNLEtBQ3JDbUIsRUFBUyxJQUFNNUIsRUFBSTJCLEVBQVEsTUFFakMsT0FBT2hCLEdBQ0RELEdBQVMsRUFDTSxJQUFiQSxFQUFRLEdBQ00sSUFBYkEsRUFBUSxHQUFXLEdBRXhCUCxLQUFLQyxPQUFpQixJQUFUd0IsRUFBZ0IsS0FBTyxNQUNwQixLQUFkQSxFQUFTLEdBQ2tCLFFBQTVCekIsS0FBS0MsTUFBTXVCLEVBQVMsT0FBb0I1QixnQkFBZ0IsSyxzQ0FJeENlLEdBQ3JCLElBSUllLEVBSkVDLEVBQU0zQixLQUFLQyxNQUFNVSxHQUFNLEdBQ3ZCRSxFQUFTYyxFQUFNdEIsRUFBVXVCLGdCQUFnQixJQUFLLEVBQUcsR0FDakRDLEVBQVE3QixLQUFLQyxNQUFNWSxFQUFTLFNBQzVCaUIsRUFBUWpDLEVBQUlnQixFQUFRLFNBRTFCLEdBQWMsVUFBVmlCLEVBQ0ZKLEVBQVMsU0FDSixDQUNMLElBQU1LLEVBQU8vQixLQUFLQyxNQUFNNkIsRUFBUSxLQUMxQkUsRUFBT25DLEVBQUlpQyxFQUFPLEtBQ3hCSixFQUFTMUIsS0FBS0MsT0FBUSxLQUFPOEIsRUFBUyxLQUFPQyxFQUFRLE1BQVEsU0FDekRELEVBQU8sRUFFYixJQUFJekIsRUFBT29CLEVBQVUsS0FBT0csRUFBUyxJQUNqQ3ZCLEdBQVEsSUFDVkEsR0FBUSxHQUVWLElBQU0yQixFQUFRTixFQUFNdEIsRUFBVXVCLGdCQUFnQnRCLEVBQU0sRUFBRyxHQUFNLEVBQ3ZEQyxFQUFTMEIsR0FBUSxJQUFPakMsS0FBS2tDLEtBQUtELEVBQU8sSUFBTWpDLEtBQUtrQyxNQUFNRCxFQUFPLEdBQUssSUFHNUUsTUFBTyxDQUFDM0IsRUFBTUMsRUFGRG9CLEVBQU10QixFQUFVdUIsZ0JBQWdCdEIsRUFBTUMsRUFBTyxHQUFNLEsseUNBS3hDRCxFQUFNQyxFQUFPQyxHQUNyQyxJQUFNMkIsRUFBUzlCLEVBQVV1QixnQkFBZ0J0QixFQUFNQyxFQUFPQyxHQUV0RCxPQUFPSCxFQUFVK0Isa0JBQWtCRCxLLHlDQUdYN0IsRUFBTUMsRUFBT0MsR0FDckMsSUFBTTJCLEVBQVM5QixFQUFVa0Isa0JBQWtCakIsRUFBTUMsRUFBT0MsR0FFeEQsT0FBT0gsRUFBVWdDLGdCQUFnQkYsTyx5UEN6R2hCRyxFLFdBQ25CLGFBQWdDLElBQXBCQyxFQUFvQix1REFBWixJQUFJQyxNLDRGQUFRLFNBQzlCcEYsS0FBS21GLE1BQVFBLEVBQ1RFLE1BQU1DLFFBQVFILElBQ2hCbkYsS0FBS3VGLEtBQU9KLEVBQU1LLElBQUksU0FBQ0MsR0FBRCxPQUFTQyxTQUFTRCxFQUFLLE1BQzdDekYsS0FBSzJGLEdBQUszRixLQUFLNEYsZUFDTlQsYUFBaUJDLE9BQzFCcEYsS0FBSzJGLEdBQUtSLEVBQ1ZuRixLQUFLdUYsS0FBT0wsRUFBTVcsU0FBUzdGLEtBQUttRixRLHVEQVVwQkksR0FDZCxJQUFNTyxFQUFhN0MsRUFBVWtCLGtCQUMzQm9CLEVBQUtRLGNBQ0xSLEVBQUtTLFdBQWEsRUFDbEJULEVBQUtVLFdBSVAsT0FGY2hELEVBQVVnQyxnQkFBZ0JhLEssZ0NBTXpCUCxHQUFRLE9BQU9MLEVBQU1XLFNBQVNOLEssa0NBVTVCckMsRUFBTUMsRUFBT0MsR0FDOUIsSUFBTThDLEVBQVFqRCxFQUFVK0Isa0JBQ3RCL0IsRUFBVXVCLGdCQUFnQnRCLEVBQU1DLEVBQU9DLElBR3pDLE9BQU8sSUFBSWdDLEtBQUtjLEVBQU0sR0FBSUEsRUFBTSxHQUFLLEVBQUdBLEVBQU0sTSxtQ0FJNUJoRCxFQUFNQyxFQUFPQyxHQUFPLE9BQU84QixFQUFNVSxZQUFZMUMsRUFBTUMsRUFBT0MsSyxpQ0FRNURGLEdBQ2hCLE9BQU9ELEVBQVVrRCxZQUFZakQsSyxrQ0FVWkEsRUFBTUMsR0FDdkIsSUFBSWlELEVBQWFsRCxFQUFPTixLQUFLQyxNQUFNTSxFQUFRLElBQ3ZDa0QsRUFBY2xELEVBQWtDLEdBQXpCUCxLQUFLQyxNQUFNTSxFQUFRLElBUzlDLE9BUElrRCxFQUFjLEdBQ2hCQSxHQUFlLEdBQ2ZELEdBQWMsR0FDVyxJQUFoQkMsSUFDVEEsRUFBYyxJQUdaQSxFQUFjLEVBQ1QsR0FDSEEsRUFBYyxHQUNYLEdBQ0huQixFQUFNb0IsV0FBV0YsR0FDZCxHQUVGLE8sdUNBT1AsT0FBT2xCLEVBQU1VLFlBQVk1RixLQUFLdUYsS0FBSyxHQUFJdkYsS0FBS3VGLEtBQUssR0FBSXZGLEtBQUt1RixLQUFLLE0sb0NBUy9ELE9BQU92RixLQUFLdUYsS0FBSyxLLGtDQVNQckMsR0FHVixPQUZBbEQsS0FBS3VGLEtBQUssR0FBS0csU0FBU3hDLEVBQU0sSUFDOUJsRCxLQUFLbUYsTUFBUW5GLEtBQUs0RixjQUNYNUYsTyxpQ0FTUCxPQUFPQSxLQUFLdUYsS0FBSyxLLCtCQVNWcEMsR0FDUCxJQUFNb0QsRUY5SEgsU0FBa0JyRCxFQUFNQyxHQUM3QixHQUFJQSxFQUFRLElBQU1BLEdBQVMsRUFBRyxDQUM1QixJQUFNcUQsRUFBVzVELEtBQUtDLE9BQU9NLEVBQVEsR0FBSyxJQUkxQyxNQUFPLENBSFNELEVBQU9zRCxFQUNOckQsRUFBb0IsR0FBWHFELEdBSzVCLE1BQU8sQ0FBQ3RELEVBQU1DLEdFcUhFc0QsQ0FBaUJ6RyxLQUFLK0YsY0FBZUwsU0FBU3ZDLEVBQU8sS0FLbkUsT0FKQW5ELEtBQUt1RixLQUFLLEdBQUtnQixFQUFNLEdBQ3JCdkcsS0FBS3VGLEtBQUssR0FBS2dCLEVBQU0sR0FDckJ2RyxLQUFLbUYsTUFBUW5GLEtBQUs0RixjQUVYNUYsTyxnQ0FTUCxPQUFPQSxLQUFLdUYsS0FBSyxLLDhCQVNYQSxHQUlOLE9BSEF2RixLQUFLdUYsS0FBSyxHQUFLRyxTQUFTSCxFQUFNLElBQzlCdkYsS0FBS21GLE1BQVFuRixLQUFLNEYsY0FFWDVGLE8sK0JBU1AsT0FBT0EsS0FBSzJGLEdBQUdlLFcsNkJBU1ZDLEdBQ0wsSUFBSUMsRUYzSkQsU0FBU0MsRUFBWTlELEVBQUt3QyxHQUMvQixJQUFNdUIsRUFBUS9ELEVBQUkrRCxNQUFNLFNBQ3hCLElBQUtBLEVBQVMsT0FBTy9ELEVBQ3JCLE9BQVErRCxFQUFNLElBQ1osSUFBSyxPQUNMLElBQUssTUFFSCxPQURjRCxFQUFZOUQsRUFBSWdFLFFBQVFELEVBQU92QixFQUFLUSxlQUFnQlIsR0FHcEUsSUFBSyxLQUlILE9BSGNzQixFQUNaOUQsRUFBSWdFLFFBQVFELEVBQU9FLE9BQU96QixFQUFLUSxlQUFla0IsTUFBTSxJQUFLMUIsR0FJN0QsUUFDRSxPQUFPeEMsR0UySUkwRCxDQUFvQkUsRUFBUTNHLE1BSXpDLE9BRkE0RyxFRjlHRyxTQUFTTSxFQUFXbkUsRUFBS3dDLEdBQzlCLElBQU11QixFQUFRL0QsRUFBSStELE1BQU0sU0FDeEIsSUFBS0EsRUFBUyxPQUFPL0QsRUFDckIsT0FBUStELEVBQU0sSUFDWixJQUFLLElBRUgsT0FEY0ksRUFBV25FLEVBQUlnRSxRQUFRRCxFQUFPdkIsRUFBS1UsV0FBWVYsR0FHL0QsSUFBSyxLQUNILElBQU00QixFQUFrQnJFLEVBQVl5QyxFQUFLVSxVQUFVbUIsWUFFbkQsT0FEY0YsRUFBV25FLEVBQUlnRSxRQUFRRCxFQUFPSyxHQUFrQjVCLEdBR2hFLElBQUssSUFDTCxJQUFLLEtBRUgsT0FEYzJCLEVBQVduRSxFQUFJZ0UsUUFBUUQsRUFBT3pFLFlBQVVrRCxFQUFLbUIsV0FBWW5CLEdBR3pFLElBQUssTUFDTCxJQUFLLE9BRUgsT0FEYzJCLEVBQVduRSxFQUFJZ0UsUUFBUUQsRUFBT3hFLGFBQVdpRCxFQUFLbUIsV0FBWW5CLEdBRzFFLFFBQ0UsT0FBT3hDLEdFc0ZBMEQsQ0FEVEcsRUZ2SUcsU0FBU1MsRUFBYXRFLEVBQUt3QyxHQUNoQyxJQUFNdUIsRUFBUS9ELEVBQUkrRCxNQUFNLFNBQ3hCLElBQUtBLEVBQVMsT0FBTy9ELEVBQ3JCLE9BQVErRCxFQUFNLElBQ1osSUFBSyxJQUVILE9BRGNPLEVBQWF0RSxFQUFJZ0UsUUFBUUQsRUFBT3ZCLEVBQUtTLFlBQWFULEdBR2xFLElBQUssS0FDSCxJQUFNK0IsRUFBbUJ4RSxFQUFZeUMsRUFBS1MsV0FBV29CLFlBRXJELE9BRGNDLEVBQWF0RSxFQUFJZ0UsUUFBUUQsRUFBT1EsR0FBbUIvQixHQUduRSxJQUFLLE1BQ0wsSUFBSyxPQUlILE9BSGM4QixFQUNadEUsRUFBSWdFLFFBQVFELEVBQU8xRSxjQUFZbUQsRUFBS1MsV0FBYSxJQUFLVCxHQUkxRCxRQUNFLE9BQU94QyxHRWtIQTBELENBQXFCRyxFQUFRNUcsTUFDRkEsVyIsImZpbGUiOiJqZGF0ZS5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jylcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkoKTtcblx0ZWxzZSBpZih0eXBlb2YgZGVmaW5lID09PSAnZnVuY3Rpb24nICYmIGRlZmluZS5hbWQpXG5cdFx0ZGVmaW5lKFwiSkRhdGVcIiwgW10sIGZhY3RvcnkpO1xuXHRlbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jylcblx0XHRleHBvcnRzW1wiSkRhdGVcIl0gPSBmYWN0b3J5KCk7XG5cdGVsc2Vcblx0XHRyb290W1wiSkRhdGVcIl0gPSBmYWN0b3J5KCk7XG59KSh0aGlzLCBmdW5jdGlvbigpIHtcbnJldHVybiAiLCIgXHQvLyBUaGUgbW9kdWxlIGNhY2hlXG4gXHR2YXIgaW5zdGFsbGVkTW9kdWxlcyA9IHt9O1xuXG4gXHQvLyBUaGUgcmVxdWlyZSBmdW5jdGlvblxuIFx0ZnVuY3Rpb24gX193ZWJwYWNrX3JlcXVpcmVfXyhtb2R1bGVJZCkge1xuXG4gXHRcdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuIFx0XHRpZihpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSkge1xuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuIFx0XHR9XG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRpOiBtb2R1bGVJZCxcbiBcdFx0XHRsOiBmYWxzZSxcbiBcdFx0XHRleHBvcnRzOiB7fVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sID0gdHJ1ZTtcblxuIFx0XHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuIFx0XHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG4gXHR9XG5cblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGVzIG9iamVjdCAoX193ZWJwYWNrX21vZHVsZXNfXylcbiBcdF9fd2VicGFja19yZXF1aXJlX18ubSA9IG1vZHVsZXM7XG5cbiBcdC8vIGV4cG9zZSB0aGUgbW9kdWxlIGNhY2hlXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLmMgPSBpbnN0YWxsZWRNb2R1bGVzO1xuXG4gXHQvLyBkZWZpbmUgZ2V0dGVyIGZ1bmN0aW9uIGZvciBoYXJtb255IGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uZCA9IGZ1bmN0aW9uKGV4cG9ydHMsIG5hbWUsIGdldHRlcikge1xuIFx0XHRpZighX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIG5hbWUpKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIG5hbWUsIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBnZXR0ZXIgfSk7XG4gXHRcdH1cbiBcdH07XG5cbiBcdC8vIGRlZmluZSBfX2VzTW9kdWxlIG9uIGV4cG9ydHNcbiBcdF9fd2VicGFja19yZXF1aXJlX18uciA9IGZ1bmN0aW9uKGV4cG9ydHMpIHtcbiBcdFx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG4gXHRcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG4gXHRcdH1cbiBcdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbiBcdH07XG5cbiBcdC8vIGNyZWF0ZSBhIGZha2UgbmFtZXNwYWNlIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDE6IHZhbHVlIGlzIGEgbW9kdWxlIGlkLCByZXF1aXJlIGl0XG4gXHQvLyBtb2RlICYgMjogbWVyZ2UgYWxsIHByb3BlcnRpZXMgb2YgdmFsdWUgaW50byB0aGUgbnNcbiBcdC8vIG1vZGUgJiA0OiByZXR1cm4gdmFsdWUgd2hlbiBhbHJlYWR5IG5zIG9iamVjdFxuIFx0Ly8gbW9kZSAmIDh8MTogYmVoYXZlIGxpa2UgcmVxdWlyZVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy50ID0gZnVuY3Rpb24odmFsdWUsIG1vZGUpIHtcbiBcdFx0aWYobW9kZSAmIDEpIHZhbHVlID0gX193ZWJwYWNrX3JlcXVpcmVfXyh2YWx1ZSk7XG4gXHRcdGlmKG1vZGUgJiA4KSByZXR1cm4gdmFsdWU7XG4gXHRcdGlmKChtb2RlICYgNCkgJiYgdHlwZW9mIHZhbHVlID09PSAnb2JqZWN0JyAmJiB2YWx1ZSAmJiB2YWx1ZS5fX2VzTW9kdWxlKSByZXR1cm4gdmFsdWU7XG4gXHRcdHZhciBucyA9IE9iamVjdC5jcmVhdGUobnVsbCk7XG4gXHRcdF9fd2VicGFja19yZXF1aXJlX18ucihucyk7XG4gXHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShucywgJ2RlZmF1bHQnLCB7IGVudW1lcmFibGU6IHRydWUsIHZhbHVlOiB2YWx1ZSB9KTtcbiBcdFx0aWYobW9kZSAmIDIgJiYgdHlwZW9mIHZhbHVlICE9ICdzdHJpbmcnKSBmb3IodmFyIGtleSBpbiB2YWx1ZSkgX193ZWJwYWNrX3JlcXVpcmVfXy5kKG5zLCBrZXksIGZ1bmN0aW9uKGtleSkgeyByZXR1cm4gdmFsdWVba2V5XTsgfS5iaW5kKG51bGwsIGtleSkpO1xuIFx0XHRyZXR1cm4gbnM7XG4gXHR9O1xuXG4gXHQvLyBnZXREZWZhdWx0RXhwb3J0IGZ1bmN0aW9uIGZvciBjb21wYXRpYmlsaXR5IHdpdGggbm9uLWhhcm1vbnkgbW9kdWxlc1xuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5uID0gZnVuY3Rpb24obW9kdWxlKSB7XG4gXHRcdHZhciBnZXR0ZXIgPSBtb2R1bGUgJiYgbW9kdWxlLl9fZXNNb2R1bGUgP1xuIFx0XHRcdGZ1bmN0aW9uIGdldERlZmF1bHQoKSB7IHJldHVybiBtb2R1bGVbJ2RlZmF1bHQnXTsgfSA6XG4gXHRcdFx0ZnVuY3Rpb24gZ2V0TW9kdWxlRXhwb3J0cygpIHsgcmV0dXJuIG1vZHVsZTsgfTtcbiBcdFx0X193ZWJwYWNrX3JlcXVpcmVfXy5kKGdldHRlciwgJ2EnLCBnZXR0ZXIpO1xuIFx0XHRyZXR1cm4gZ2V0dGVyO1xuIFx0fTtcblxuIFx0Ly8gT2JqZWN0LnByb3RvdHlwZS5oYXNPd25Qcm9wZXJ0eS5jYWxsXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLm8gPSBmdW5jdGlvbihvYmplY3QsIHByb3BlcnR5KSB7IHJldHVybiBPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwob2JqZWN0LCBwcm9wZXJ0eSk7IH07XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG5cbiBcdC8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xuIFx0cmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oX193ZWJwYWNrX3JlcXVpcmVfXy5zID0gMSk7XG4iLCJtb2R1bGUuZXhwb3J0cyA9IHtcbiAgTU9OVEhfTkFNRVM6IFsn2YHYsdmI2LHYr9uM2YYnLCAn2KfYsdiv24zYqNmH2LTYqicsICfYrtix2K/Yp9ivJywgJ9iq24zYsScsICfYp9mF2LHYr9in2K8nLCAn2LTZh9ix24zZiNixJywgJ9mF2YfYsScsICfYotio2KfZhicsICfYotiw2LEnLCAn2K/bjCcsICfYqNmH2YXZhicsICfYp9iz2YHZhtivJ10sXG4gIEFCQlJfREFZUzogWyfbsdi0JywgJ9uy2LQnLCAn27PYtCcsICfbtNi0JywgJ9u12LQnLCAn2KwnLCAn2LQnXSxcbiAgREFZU19OQU1FUzogWyfbjNqp2LTZhtio2YcnLCAn2K/ZiNi02YbYqNmHJywgJ9iz2YfigIzYtNmG2KjZhycsICfahtmH2KfYsdi02YbYqNmHJywgJ9m+2YbYrOKAjNi02YbYqNmHJywgJ9is2YXYudmHJywgJ9i02YbYqNmHJ10sXG4gIEdSRUdPUklBTl9FUE9DSDogMTcyMTQyNS41LFxuICBQRVJTSUFOX0VQT0NIOiAxOTQ4MzIwLjVcbn07XG4iLCIvKiBlc2xpbnQtZGlzYWJsZSBuby11bnVzZWQtdmFycyAqL1xuXG5pbXBvcnQge1xuICBNT05USF9OQU1FUyxcbiAgQUJCUl9EQVlTLFxuICBEQVlTX05BTUVTXG59IGZyb20gJy4vY29uc3RhbnRzJztcblxuZXhwb3J0IGZ1bmN0aW9uIGRpdihhLCBiKSB7XG4gIHJldHVybiBNYXRoLmZsb29yKGEgLyBiKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIG1vZChhLCBiKSB7XG4gIHJldHVybiBhIC0gKE1hdGguZmxvb3IoYSAvIGIpICogYik7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBmaXhNb250aCh5ZWFyLCBtb250aCkge1xuICBpZiAobW9udGggPiAxMiB8fCBtb250aCA8PSAwKSB7XG4gICAgY29uc3QgeWVhckRpZmYgPSBNYXRoLmZsb29yKChtb250aCAtIDEpIC8gMTIpO1xuICAgIGNvbnN0IG5ld1llYXIgPSB5ZWFyIC0geWVhckRpZmY7XG4gICAgY29uc3QgbmV3TW9udGggPSBtb250aCAtICh5ZWFyRGlmZiAqIDEyKTtcblxuICAgIHJldHVybiBbbmV3WWVhciwgbmV3TW9udGhdO1xuICB9XG5cbiAgcmV0dXJuIFt5ZWFyLCBtb250aF07XG59XG5cbmV4cG9ydCBmdW5jdGlvbiB6ZXJvTGVhZGluZyhzdHIpIHtcbiAgaWYgKHN0ciAmJiBzdHIubGVuZ3RoID09PSAxKSB7IHJldHVybiBgMCR7c3RyfWA7IH1cbiAgcmV0dXJuIHN0cjtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlcGxhY2VZZWFyKHN0ciwgZGF0ZSkge1xuICBjb25zdCBtYXRjaCA9IHN0ci5tYXRjaCgvW3lZXSsvKTtcbiAgaWYgKCFtYXRjaCkgeyByZXR1cm4gc3RyOyB9XG4gIHN3aXRjaCAobWF0Y2hbMF0pIHtcbiAgICBjYXNlICdZWVlZJzpcbiAgICBjYXNlICdZWVknOiB7XG4gICAgICBjb25zdCB2YWx1ZSA9IHJlcGxhY2VZZWFyKHN0ci5yZXBsYWNlKG1hdGNoLCBkYXRlLmdldEZ1bGxZZWFyKCkpLCBkYXRlKTtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG4gICAgY2FzZSAnWVknOiB7XG4gICAgICBjb25zdCB2YWx1ZSA9IHJlcGxhY2VZZWFyKFxuICAgICAgICBzdHIucmVwbGFjZShtYXRjaCwgU3RyaW5nKGRhdGUuZ2V0RnVsbFllYXIoKSkuc2xpY2UoMikpLCBkYXRlXG4gICAgICApO1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cbiAgICBkZWZhdWx0OiB7XG4gICAgICByZXR1cm4gc3RyO1xuICAgIH1cbiAgfVxufVxuXG5leHBvcnQgZnVuY3Rpb24gcmVwbGFjZU1vbnRoKHN0ciwgZGF0ZSkge1xuICBjb25zdCBtYXRjaCA9IHN0ci5tYXRjaCgvW21NXSsvKTtcbiAgaWYgKCFtYXRjaCkgeyByZXR1cm4gc3RyOyB9XG4gIHN3aXRjaCAobWF0Y2hbMF0pIHtcbiAgICBjYXNlICdNJzoge1xuICAgICAgY29uc3QgdmFsdWUgPSByZXBsYWNlTW9udGgoc3RyLnJlcGxhY2UobWF0Y2gsIGRhdGUuZ2V0TW9udGgoKSksIGRhdGUpO1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cbiAgICBjYXNlICdNTSc6IHtcbiAgICAgIGNvbnN0IHplcm9MZWFkaW5nTW9udGggPSB6ZXJvTGVhZGluZyhkYXRlLmdldE1vbnRoKCkudG9TdHJpbmcoKSk7XG4gICAgICBjb25zdCB2YWx1ZSA9IHJlcGxhY2VNb250aChzdHIucmVwbGFjZShtYXRjaCwgemVyb0xlYWRpbmdNb250aCksIGRhdGUpO1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cbiAgICBjYXNlICdNTU0nOlxuICAgIGNhc2UgJ01NTU0nOiB7XG4gICAgICBjb25zdCB2YWx1ZSA9IHJlcGxhY2VNb250aChcbiAgICAgICAgc3RyLnJlcGxhY2UobWF0Y2gsIE1PTlRIX05BTUVTW2RhdGUuZ2V0TW9udGgoKSAtIDFdKSwgZGF0ZVxuICAgICAgKTtcbiAgICAgIHJldHVybiB2YWx1ZTtcbiAgICB9XG4gICAgZGVmYXVsdDoge1xuICAgICAgcmV0dXJuIHN0cjtcbiAgICB9XG4gIH1cbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHJlcGxhY2VEYXkoc3RyLCBkYXRlKSB7XG4gIGNvbnN0IG1hdGNoID0gc3RyLm1hdGNoKC9bZERdKy8pO1xuICBpZiAoIW1hdGNoKSB7IHJldHVybiBzdHI7IH1cbiAgc3dpdGNoIChtYXRjaFswXSkge1xuICAgIGNhc2UgJ0QnOiB7XG4gICAgICBjb25zdCB2YWx1ZSA9IHJlcGxhY2VEYXkoc3RyLnJlcGxhY2UobWF0Y2gsIGRhdGUuZ2V0RGF0ZSgpKSwgZGF0ZSk7XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuICAgIGNhc2UgJ0REJzoge1xuICAgICAgY29uc3QgemVyb0xlYWRpbmdEYXRlID0gemVyb0xlYWRpbmcoZGF0ZS5nZXREYXRlKCkudG9TdHJpbmcoKSk7XG4gICAgICBjb25zdCB2YWx1ZSA9IHJlcGxhY2VEYXkoc3RyLnJlcGxhY2UobWF0Y2gsIHplcm9MZWFkaW5nRGF0ZSksIGRhdGUpO1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cbiAgICBjYXNlICdkJzpcbiAgICBjYXNlICdkZCc6IHtcbiAgICAgIGNvbnN0IHZhbHVlID0gcmVwbGFjZURheShzdHIucmVwbGFjZShtYXRjaCwgQUJCUl9EQVlTW2RhdGUuZ2V0RGF5KCldKSwgZGF0ZSk7XG4gICAgICByZXR1cm4gdmFsdWU7XG4gICAgfVxuICAgIGNhc2UgJ2RkZCc6XG4gICAgY2FzZSAnZGRkZCc6IHtcbiAgICAgIGNvbnN0IHZhbHVlID0gcmVwbGFjZURheShzdHIucmVwbGFjZShtYXRjaCwgREFZU19OQU1FU1tkYXRlLmdldERheSgpXSksIGRhdGUpO1xuICAgICAgcmV0dXJuIHZhbHVlO1xuICAgIH1cbiAgICBkZWZhdWx0OiB7XG4gICAgICByZXR1cm4gc3RyO1xuICAgIH1cbiAgfVxufVxuIiwiaW1wb3J0IHsgbW9kIH0gZnJvbSAnLi9oZWxwZXJzJztcbmltcG9ydCB7IEdSRUdPUklBTl9FUE9DSCwgUEVSU0lBTl9FUE9DSCB9IGZyb20gJy4vY29uc3RhbnRzJztcblxuZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ29udmVydGVyIHtcbiAgLy8gIExFQVBfR1JFR09SSUFOICAtLSAgSXMgYSBnaXZlbiB5ZWFyIGluIHRoZSBHcmVnb3JpYW4gY2FsZW5kYXIgYSBsZWFwIHllYXI/XG4gIHN0YXRpYyBsZWFwR3JlZ29yaWFuKHllYXIpIHtcbiAgICByZXR1cm4gKCh5ZWFyICUgNCkgPT09IDApXG4gICAgICAmJiAoISgoKHllYXIgJSAxMDApID09PSAwKSAmJiAoKHllYXIgJSA0MDApICE9PSAwKSkpO1xuICB9XG5cbiAgLy8gR1JFR09SSUFOX1RPX0pEICAtLSAgRGV0ZXJtaW5lIEp1bGlhbiBkYXkgbnVtYmVyIGZyb20gR3JlZ29yaWFuIGNhbGVuZGFyIGRhdGVcbiAgc3RhdGljIGdyZWdvcmlhblRvSnVsaWFuKHllYXIsIG1vbnRoLCBkYXkpIHtcbiAgICBsZXQgcGFkO1xuICAgIGlmIChtb250aCA8PSAyKSB7XG4gICAgICBwYWQgPSAwO1xuICAgIH0gZWxzZSBpZiAoQ29udmVydGVyLmxlYXBHcmVnb3JpYW4oeWVhcikpIHtcbiAgICAgIHBhZCA9IC0xO1xuICAgIH0gZWxzZSB7XG4gICAgICBwYWQgPSAtMjtcbiAgICB9XG5cbiAgICByZXR1cm4gKEdSRUdPUklBTl9FUE9DSCAtIDEpXG4gICAgICArICgzNjUgKiAoeWVhciAtIDEpKVxuICAgICAgKyBNYXRoLmZsb29yKCh5ZWFyIC0gMSkgLyA0KVxuICAgICAgKyAoLU1hdGguZmxvb3IoKHllYXIgLSAxKSAvIDEwMCkpXG4gICAgICArIE1hdGguZmxvb3IoKHllYXIgLSAxKSAvIDQwMClcbiAgICAgICsgTWF0aC5mbG9vcigoKCgzNjcgKiBtb250aCkgLSAzNjIpIC8gMTIpICsgKHBhZCArIGRheSkpO1xuICB9XG5cbiAgLy8gIEpEX1RPX0dSRUdPUklBTiAgLS0gIENhbGN1bGF0ZSBHcmVnb3JpYW4gY2FsZW5kYXIgZGF0ZSBmcm9tIEp1bGlhbiBkYXlcbiAgc3RhdGljIGp1bGlhblRvR3JlZ29yaWFuKGpkKSB7XG4gICAgY29uc3Qgd2pkID0gTWF0aC5mbG9vcihqZCAtIDAuNSkgKyAwLjU7XG4gICAgY29uc3QgZGVwb2NoID0gd2pkIC0gR1JFR09SSUFOX0VQT0NIO1xuICAgIGNvbnN0IHF1YWRyaWNlbnQgPSBNYXRoLmZsb29yKGRlcG9jaCAvIDE0NjA5Nyk7XG4gICAgY29uc3QgZHFjID0gbW9kKGRlcG9jaCwgMTQ2MDk3KTtcbiAgICBjb25zdCBjZW50ID0gTWF0aC5mbG9vcihkcWMgLyAzNjUyNCk7XG4gICAgY29uc3QgZGNlbnQgPSBtb2QoZHFjLCAzNjUyNCk7XG4gICAgY29uc3QgcXVhZCA9IE1hdGguZmxvb3IoZGNlbnQgLyAxNDYxKTtcbiAgICBjb25zdCBkcXVhZCA9IG1vZChkY2VudCwgMTQ2MSk7XG4gICAgY29uc3QgeWluZGV4ID0gTWF0aC5mbG9vcihkcXVhZCAvIDM2NSk7XG4gICAgbGV0IHllYXIgPSAocXVhZHJpY2VudCAqIDQwMCkgKyAoY2VudCAqIDEwMCkgKyAocXVhZCAqIDQpICsgeWluZGV4O1xuICAgIGlmICghKChjZW50ID09PSA0KSB8fCAoeWluZGV4ID09PSA0KSkpIHsgeWVhciArPSAxOyB9XG4gICAgY29uc3QgeWVhcmRheSA9IHdqZCAtIENvbnZlcnRlci5ncmVnb3JpYW5Ub0p1bGlhbih5ZWFyLCAxLCAxKTtcbiAgICBsZXQgbGVhcGFkajtcbiAgICBpZiAod2pkIDwgQ29udmVydGVyLmdyZWdvcmlhblRvSnVsaWFuKHllYXIsIDMsIDEpKSB7XG4gICAgICBsZWFwYWRqID0gMDtcbiAgICB9IGVsc2UgaWYgKENvbnZlcnRlci5sZWFwR3JlZ29yaWFuKHllYXIpID8gMSA6IDIpIHtcbiAgICAgIGxlYXBhZGogPSAxO1xuICAgIH0gZWxzZSB7XG4gICAgICBsZWFwYWRqID0gMjtcbiAgICB9XG4gICAgY29uc3QgbW9udGggPSBNYXRoLmZsb29yKCgoKHllYXJkYXkgKyBsZWFwYWRqKSAqIDEyKSArIDM3MykgLyAzNjcpO1xuICAgIGNvbnN0IGRheSA9ICh3amQgLSBDb252ZXJ0ZXIuZ3JlZ29yaWFuVG9KdWxpYW4oeWVhciwgbW9udGgsIDEpKSArIDE7XG5cbiAgICByZXR1cm4gW3llYXIsIG1vbnRoLCBkYXldO1xuICB9XG5cbiAgLy8gIExFQVBfUEVSU0lBTiAgLS0gIElzIGEgZ2l2ZW4geWVhciBhIGxlYXAgeWVhciBpbiB0aGUgUGVyc2lhbiBjYWxlbmRhciA/XG4gIHN0YXRpYyBsZWFwUGVyc2lhbih5ZWFyKSB7XG4gICAgcmV0dXJuIChcbiAgICAgICgoKCgoeWVhciAtICgoeWVhciA+IDApID8gNDc0IDogNDczKSkgJSAyODIwKSArIDQ3NCkgKyAzOCkgKiA2ODIpICUgMjgxNlxuICAgICkgPCA2ODI7XG4gIH1cblxuICAvLyAgUEVSU0lBTl9UT19KRCAgLS0gIERldGVybWluZSBKdWxpYW4gZGF5IGZyb20gUGVyc2lhbiBkYXRlXG4gIHN0YXRpYyBwZXJzaWFuVG9KdWxpYW4oeWVhciwgbW9udGgsIGRheSkge1xuICAgIGNvbnN0IGVwYmFzZSA9IHllYXIgLSAoKHllYXIgPj0gMCkgPyA0NzQgOiA0NzMpO1xuICAgIGNvbnN0IGVweWVhciA9IDQ3NCArIG1vZChlcGJhc2UsIDI4MjApO1xuXG4gICAgcmV0dXJuIGRheVxuICAgICAgKyAoKG1vbnRoIDw9IDcpXG4gICAgICAgID8gKChtb250aCAtIDEpICogMzEpXG4gICAgICAgIDogKCgobW9udGggLSAxKSAqIDMwKSArIDYpXG4gICAgICApXG4gICAgICArIE1hdGguZmxvb3IoKChlcHllYXIgKiA2ODIpIC0gMTEwKSAvIDI4MTYpXG4gICAgICArICgoZXB5ZWFyIC0gMSkgKiAzNjUpXG4gICAgICArIChNYXRoLmZsb29yKGVwYmFzZSAvIDI4MjApICogMTAyOTk4MykgKyAoUEVSU0lBTl9FUE9DSCAtIDEpO1xuICB9XG5cbiAgLy8gIEpEX1RPX1BFUlNJQU4gIC0tICBDYWxjdWxhdGUgUGVyc2lhbiBkYXRlIGZyb20gSnVsaWFuIGRheVxuICBzdGF0aWMganVsaWFuVG9QZXJzaWFuKGpkKSB7XG4gICAgY29uc3QgbmpkID0gTWF0aC5mbG9vcihqZCkgKyAwLjU7XG4gICAgY29uc3QgZGVwb2NoID0gbmpkIC0gQ29udmVydGVyLnBlcnNpYW5Ub0p1bGlhbig0NzUsIDEsIDEpO1xuICAgIGNvbnN0IGN5Y2xlID0gTWF0aC5mbG9vcihkZXBvY2ggLyAxMDI5OTgzKTtcbiAgICBjb25zdCBjeWVhciA9IG1vZChkZXBvY2gsIDEwMjk5ODMpO1xuICAgIGxldCB5Y3ljbGU7XG4gICAgaWYgKGN5ZWFyID09PSAxMDI5OTgyKSB7XG4gICAgICB5Y3ljbGUgPSAyODIwO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBhdXgxID0gTWF0aC5mbG9vcihjeWVhciAvIDM2Nik7XG4gICAgICBjb25zdCBhdXgyID0gbW9kKGN5ZWFyLCAzNjYpO1xuICAgICAgeWN5Y2xlID0gTWF0aC5mbG9vcigoKDIxMzQgKiBhdXgxKSArICgyODE2ICogYXV4MikgKyAyODE1KSAvIDEwMjg1MjIpXG4gICAgICAgICsgYXV4MSArIDE7XG4gICAgfVxuICAgIGxldCB5ZWFyID0geWN5Y2xlICsgKDI4MjAgKiBjeWNsZSkgKyA0NzQ7XG4gICAgaWYgKHllYXIgPD0gMCkge1xuICAgICAgeWVhciAtPSAxO1xuICAgIH1cbiAgICBjb25zdCB5ZGF5ID0gKG5qZCAtIENvbnZlcnRlci5wZXJzaWFuVG9KdWxpYW4oeWVhciwgMSwgMSkpICsgMTtcbiAgICBjb25zdCBtb250aCA9ICh5ZGF5IDw9IDE4NikgPyBNYXRoLmNlaWwoeWRheSAvIDMxKSA6IE1hdGguY2VpbCgoeWRheSAtIDYpIC8gMzApO1xuICAgIGNvbnN0IGRheSA9IChuamQgLSBDb252ZXJ0ZXIucGVyc2lhblRvSnVsaWFuKHllYXIsIG1vbnRoLCAxKSkgKyAxO1xuXG4gICAgcmV0dXJuIFt5ZWFyLCBtb250aCwgZGF5XTtcbiAgfVxuXG4gIHN0YXRpYyBwZXJzaWFuVG9HcmVnb3JpYW4oeWVhciwgbW9udGgsIGRheSkge1xuICAgIGNvbnN0IGp1bGlhbiA9IENvbnZlcnRlci5wZXJzaWFuVG9KdWxpYW4oeWVhciwgbW9udGgsIGRheSk7XG5cbiAgICByZXR1cm4gQ29udmVydGVyLmp1bGlhblRvR3JlZ29yaWFuKGp1bGlhbik7XG4gIH1cblxuICBzdGF0aWMgZ3JlZ29yaWFuVG9QZXJzaWFuKHllYXIsIG1vbnRoLCBkYXkpIHtcbiAgICBjb25zdCBqdWxpYW4gPSBDb252ZXJ0ZXIuZ3JlZ29yaWFuVG9KdWxpYW4oeWVhciwgbW9udGgsIGRheSk7XG5cbiAgICByZXR1cm4gQ29udmVydGVyLmp1bGlhblRvUGVyc2lhbihqdWxpYW4pO1xuICB9XG59XG4iLCIvKlxuICogaHR0cHM6Ly9naXRodWIuY29tL2FyYXNobS9KRGF0ZVxuICogQGF1dGhvcjogQXJhc2ggTW91c2F2aVxuICogQHZlcnNpb246IDEuMC4wXG4gKi9cblxuaW1wb3J0IENvbnZlcnRlciBmcm9tICcuL2NvbnZlcnRlcic7XG5pbXBvcnQgKiBhcyBoZWxwZXJzIGZyb20gJy4vaGVscGVycyc7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIEpEYXRlIHtcbiAgY29uc3RydWN0b3IoaW5wdXQgPSBuZXcgRGF0ZSgpKSB7XG4gICAgdGhpcy5pbnB1dCA9IGlucHV0O1xuICAgIGlmIChBcnJheS5pc0FycmF5KGlucHV0KSkge1xuICAgICAgdGhpcy5kYXRlID0gaW5wdXQubWFwKChudW0pID0+IHBhcnNlSW50KG51bSwgMTApKTtcbiAgICAgIHRoaXMuX2QgPSB0aGlzLnRvR3JlZ29yaWFuKCk7XG4gICAgfSBlbHNlIGlmIChpbnB1dCBpbnN0YW5jZW9mIERhdGUpIHtcbiAgICAgIHRoaXMuX2QgPSBpbnB1dDtcbiAgICAgIHRoaXMuZGF0ZSA9IEpEYXRlLnRvSmFsYWxpKHRoaXMuaW5wdXQpO1xuICAgIH1cbiAgfVxuXG4gIC8qXG4gICAqIENvdmVydHMgYSBHcmVnb3JpYW4gZGF0ZSB0byBKYWxhbGkgZGF0ZVxuICAgKlxuICAgKiBAcGFyYW1zIHtEYXRlfSBkYXRlXG4gICAqIEByZXR1cm4ge0FycmF5fVxuICAgKi9cbiAgc3RhdGljIHRvSmFsYWxpKGRhdGUpIHtcbiAgICBjb25zdCBqdWxpYW5EYXRlID0gQ29udmVydGVyLmdyZWdvcmlhblRvSnVsaWFuKFxuICAgICAgZGF0ZS5nZXRGdWxsWWVhcigpLFxuICAgICAgZGF0ZS5nZXRNb250aCgpICsgMSxcbiAgICAgIGRhdGUuZ2V0RGF0ZSgpLFxuICAgICk7XG4gICAgY29uc3QgamRhdGUgPSBDb252ZXJ0ZXIuanVsaWFuVG9QZXJzaWFuKGp1bGlhbkRhdGUpO1xuXG4gICAgcmV0dXJuIGpkYXRlO1xuICB9XG5cbiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGNhbWVsY2FzZVxuICBzdGF0aWMgdG9famFsYWxpKGRhdGUpIHsgcmV0dXJuIEpEYXRlLnRvSmFsYWxpKGRhdGUpOyB9XG5cbiAgLypcbiAgICogY29udmVydHMgYSBKYWxhbGkgZGF0ZSB0byBHcmVnb3JpYW5cbiAgICpcbiAgICogQHBhcmFtcyB7TnVtYmVyfSB5ZWFyXG4gICAqIEBwYXJhbXMge051bWJlcn0gbW9udGhcbiAgICogQHBhcmFtcyB7TnVtYmVyfSBkYXlcbiAgICogQHJldHVybiB7RGF0ZX1cbiAgICovXG4gIHN0YXRpYyB0b0dyZWdvcmlhbih5ZWFyLCBtb250aCwgZGF5KSB7XG4gICAgY29uc3QgZ2RhdGUgPSBDb252ZXJ0ZXIuanVsaWFuVG9HcmVnb3JpYW4oXG4gICAgICBDb252ZXJ0ZXIucGVyc2lhblRvSnVsaWFuKHllYXIsIG1vbnRoLCBkYXkpXG4gICAgKTtcblxuICAgIHJldHVybiBuZXcgRGF0ZShnZGF0ZVswXSwgZ2RhdGVbMV0gLSAxLCBnZGF0ZVsyXSk7XG4gIH1cblxuICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY2FtZWxjYXNlXG4gIHN0YXRpYyB0b19ncmVnb3JpYW4oeWVhciwgbW9udGgsIGRheSkgeyByZXR1cm4gSkRhdGUudG9HcmVnb3JpYW4oeWVhciwgbW9udGgsIGRheSk7IH1cblxuICAvKlxuICAgKiBDaGVja3MgaWYgYSBnaXZlbiB5ZWFyIGlzIGEgbGVhcCB5ZWFyIG9yIG5vdFxuICAgKlxuICAgKiBAcGFyYW1zIHtOdW1iZXJ9IHllYXJcbiAgICogQHJldHVybiB7Qm9vbGVhbn1cbiAgICovXG4gIHN0YXRpYyBpc0xlYXBZZWFyKHllYXIpIHtcbiAgICByZXR1cm4gQ29udmVydGVyLmxlYXBQZXJzaWFuKHllYXIpO1xuICB9XG5cbiAgLypcbiAgICogUmV0dXJucyBtb250aCBsZW5ndGguXG4gICAqXG4gICAqIEBwYXJhbXMge051bWJlcn0geWVhclxuICAgKiBAcGFyYW1zIHtOdW1iZXJ9IG1vbnRoIHplcm8gYmFzZWRcbiAgICogQHJldHVybiB7TnVtYmVyfVxuICAgKi9cbiAgc3RhdGljIGRheXNJbk1vbnRoKHllYXIsIG1vbnRoKSB7XG4gICAgbGV0IGNhbGNlZFllYXIgPSB5ZWFyIC0gTWF0aC5mbG9vcihtb250aCAvIDEyKTtcbiAgICBsZXQgY2FsY2VkTW9udGggPSBtb250aCAtIChNYXRoLmZsb29yKG1vbnRoIC8gMTIpICogMTIpO1xuXG4gICAgaWYgKGNhbGNlZE1vbnRoIDwgMCkge1xuICAgICAgY2FsY2VkTW9udGggKz0gMTI7XG4gICAgICBjYWxjZWRZZWFyIC09IDE7XG4gICAgfSBlbHNlIGlmIChjYWxjZWRNb250aCA9PT0gMCkge1xuICAgICAgY2FsY2VkTW9udGggPSAxMjtcbiAgICB9XG5cbiAgICBpZiAoY2FsY2VkTW9udGggPCA2KSB7XG4gICAgICByZXR1cm4gMzE7XG4gICAgfSBpZiAoY2FsY2VkTW9udGggPCAxMSkge1xuICAgICAgcmV0dXJuIDMwO1xuICAgIH0gaWYgKEpEYXRlLmlzTGVhcFllYXIoY2FsY2VkWWVhcikpIHtcbiAgICAgIHJldHVybiAzMDtcbiAgICB9XG4gICAgcmV0dXJuIDI5O1xuICB9XG5cbiAgLypcbiAgICogQ29udmVydHMgSkRhdGUgZGF0ZSB0byBHcmVnb3JpYW5cbiAgICovXG4gIHRvR3JlZ29yaWFuKCkge1xuICAgIHJldHVybiBKRGF0ZS50b0dyZWdvcmlhbih0aGlzLmRhdGVbMF0sIHRoaXMuZGF0ZVsxXSwgdGhpcy5kYXRlWzJdKTtcbiAgfVxuXG4gIC8qXG4gICAqIFNob3dzIEphbGFsaSdzIGZ1bGwgeWVhciwgZXg6IDEzOTNcbiAgICpcbiAgICogQHJldHVybiB7SW50ZWdlcn1cbiAgICovXG4gIGdldEZ1bGxZZWFyKCkge1xuICAgIHJldHVybiB0aGlzLmRhdGVbMF07XG4gIH1cblxuICAvKlxuICAgKiBTZXRzIHRoZSBKYWxhbGkgZnVsbCB5ZWFyXG4gICAqXG4gICAqIEBwYXJhbXMge051bWJlcn0geWVhclxuICAgKiBAcmV0dXJuIHtKRGF0ZX1cbiAgICovXG4gIHNldEZ1bGxZZWFyKHllYXIpIHtcbiAgICB0aGlzLmRhdGVbMF0gPSBwYXJzZUludCh5ZWFyLCAxMCk7XG4gICAgdGhpcy5pbnB1dCA9IHRoaXMudG9HcmVnb3JpYW4oKTtcbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qXG4gICAqIFNob3dzIEphbGFsaSBtb250aCBudW1iZXIuXG4gICAqXG4gICAqIEByZXR1cm4ge051bWJlcn0gSmFsYWxpIG1vbnRoIG51bWJlclxuICAgKi9cbiAgZ2V0TW9udGgoKSB7XG4gICAgcmV0dXJuIHRoaXMuZGF0ZVsxXTtcbiAgfVxuXG4gIC8qXG4gICAqIFNldHMgdGhlIEphbGFsaSBtb250aCBudW1iZXIuIEFuIGludGVnZXIgYmV0d2VlbiAwIGFuZCAxMVxuICAgKlxuICAgKiBAcGFyYW1zIHtOdW1iZXJ9IG1vbnRoXG4gICAqIEByZXR1cm5zIHtKRGF0ZX1cbiAgICovXG4gIHNldE1vbnRoKG1vbnRoKSB7XG4gICAgY29uc3QgZml4ZWQgPSBoZWxwZXJzLmZpeE1vbnRoKHRoaXMuZ2V0RnVsbFllYXIoKSwgcGFyc2VJbnQobW9udGgsIDEwKSk7XG4gICAgdGhpcy5kYXRlWzBdID0gZml4ZWRbMF07XG4gICAgdGhpcy5kYXRlWzFdID0gZml4ZWRbMV07XG4gICAgdGhpcy5pbnB1dCA9IHRoaXMudG9HcmVnb3JpYW4oKTtcblxuICAgIHJldHVybiB0aGlzO1xuICB9XG5cbiAgLypcbiAgICogU2hvd3MgSmFsYWxpIGRheSBudW1iZXIuIEEgbnVtYmVyIGJldHdlZW4gMCB0byAzMVxuICAgKlxuICAgKiBAcmV0dXJuIHtOdW1iZXJ9IEphbGFsaSBkYXkgbnVtYmVyXG4gICAqL1xuICBnZXREYXRlKCkge1xuICAgIHJldHVybiB0aGlzLmRhdGVbMl07XG4gIH1cblxuICAvKlxuICAgKiBTZXRzIEphbGFsaSBkYXkgbnVtYmVyLiBBIG51bWJlciBiZXR3ZWVuIDAgdG8gMzFcbiAgICpcbiAgICogQHBhcmFtcyB7TnVtYmVyfSBkYXRlXG4gICAqIEByZXR1cm4ge0pEYXRlfVxuICAgKi9cbiAgc2V0RGF0ZShkYXRlKSB7XG4gICAgdGhpcy5kYXRlWzJdID0gcGFyc2VJbnQoZGF0ZSwgMTApO1xuICAgIHRoaXMuaW5wdXQgPSB0aGlzLnRvR3JlZ29yaWFuKCk7XG5cbiAgICByZXR1cm4gdGhpcztcbiAgfVxuXG4gIC8qXG4gICAqIFJldHVybnMgdGhlIGRheSBvZiB0aGUgd2VlayBmb3IgdGhlIHNwZWNpZmllZCBkYXRlLiBBIG51bWJlciBiZXR3ZWVuIDAgdG8gNlxuICAgKlxuICAgKiBAcmV0dXJucyB7TnVtYmVyfVxuICAgKi9cbiAgZ2V0RGF5KCkge1xuICAgIHJldHVybiB0aGlzLl9kLmdldERheSgpO1xuICB9XG5cbiAgLypcbiAgICogUmV0dXJucyBhIGZvcm1hdGVkIG91dHB1dCBvZiBjdXJyZW50IGRhdGVcbiAgICpcbiAgICogQHBhcmFtcyB7U3RyaW5nfSBmb3JtYXRcbiAgICogQHJldHVybiB7U3RyaW5nfVxuICAgKi9cbiAgZm9ybWF0KGZvcm1hdCkge1xuICAgIGxldCByZXN1bHQgPSBoZWxwZXJzLnJlcGxhY2VZZWFyKGZvcm1hdCwgdGhpcyk7XG4gICAgcmVzdWx0ID0gaGVscGVycy5yZXBsYWNlTW9udGgocmVzdWx0LCB0aGlzKTtcbiAgICByZXN1bHQgPSBoZWxwZXJzLnJlcGxhY2VEYXkocmVzdWx0LCB0aGlzKTtcblxuICAgIHJldHVybiByZXN1bHQ7XG4gIH1cbn1cbiJdLCJzb3VyY2VSb290IjoiIn0=